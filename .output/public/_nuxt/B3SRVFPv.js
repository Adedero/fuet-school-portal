import{f as N,A as j,B as w,c,O as Y,k as t,o as i,b as a,g as C,io as O,s as L,M as U,a3 as K,a as e,j as f,w as x,i as h,D as $,x as q,d as G,t as S,v as H,F as J,r as Q,I as W,m as X}from"#entry";import{_ as Z}from"./BrTgbP-L.js";import{_ as tt}from"./XC2qsoqq.js";import{_ as et}from"./Br_2l1z2.js";import{_ as ot}from"./7RKIiw9z.js";import{_ as it}from"./BvPn1KVB.js";import{_ as nt}from"./ZijmOHL0.js";import{a as M}from"./DyueXa58.js";import{n as P}from"./Zkazc4B7.js";import{u as st}from"./BoFo4Dkd.js";import{u as at}from"./DmuB_ewQ.js";import{_ as rt}from"./D9TAVD05.js";import"./C349kGaG.js";import"./CZ9GQ99X.js";import"./Dx-2vZsd.js";import"./Cp9dvClo.js";import"./fgKd3tbi.js";import"./DX__6iYn.js";import"./CuPKMK4g.js";import"./CRVZdzxc.js";import"./CSucrOrG.js";import"./ST9fJbop.js";import"./BePoOrxp.js";import"./CDIhCsnd.js";import"./3OEFcGef.js";import"./BZPIhiCP.js";import"./CQ9DD0Tp.js";const lt=N({__name:"submitter",props:{application:{},condition:{type:Boolean,default:!0},conditionMessage:{default:""},applicationId:{}},emits:["submit"],setup(y,{emit:u}){const b=u,n=j(),{confirmAsync:r}=O(),v=async()=>await r({title:"Submit Application",description:"Are you sure you want to submit this application? Once submitted, you cannot edit any part of the application"}),p=w(!1);async function d(){if(!y.condition){n.add({color:"error",title:"Error",description:y.conditionMessage});return}const l=M.safeParse(y.application);if(!l.success){n.add({color:"error",title:"Error",description:l.error.issues[0]?.message??"Some fields are missing. Check your applictaion and try again."});return}if(await v()){p.value=!0;try{const m=await $fetch(`/api/users/applicant/applications/${y.applicationId}/submit`,{method:"POST"});b("submit"),n.add({color:"success",title:"Success",description:m.message})}catch(m){n.add({color:"error",title:"Error",description:P(m).message})}finally{p.value=!1}}}return(l,m)=>{const _=C;return i(),c("div",{onClick:d},[Y(l.$slots,"default",{loading:t(p)},()=>[a(_,{label:"Submit",loading:t(p)},null,8,["loading"])])])}}}),ct=Object.assign(lt,{__name:"ApplicationSubmitter"}),pt={class:"w-full"},mt={class:"lg:max-w-[80%] mx-auto"},ut={class:"mt-1 flex items-center gap-2.5 justify-between"},dt={class:"text-sm"},_t={key:0},ft={key:0,class:"mt-2"},yt={class:"p-5 space-y-5 max-w-80 max-h-[26rem] overflow-y-auto"},gt={class:"grid gap-2 list-inside list-disc"},bt={class:"my-5"},vt={key:0},xt={key:1},ht={class:"flex items-start gap-2"},wt={key:0,class:"mt-5 flex items-center gap-2.5 justify-between"},kt={class:"flex items-center justify-end gap-2.5"},At={class:"flex-col-center gap-2.5"},Xt=N({__name:"index",async setup(y){let u,b;const{applicationId:n=""}=st(),{data:r,error:v,refresh:p}=([u,b]=L(()=>at(`/api/users/applicant/applications/${n}`,"$NMKLN2r7Ah")),u=await u,b(),u),d=U(()=>M.safeParse(r.value??{}).error?.issues??[]),l=w(!1),m=K("viewer"),_=w(!1),V=()=>{_.value=!0,p()};return(g,o)=>{const k=C,B=Z,E=tt,I=et,F=ot,A=it,R=nt,T=ct,z=X,D=q;return i(),c("div",pt,[e("div",mt,[e("header",null,[o[4]||(o[4]=e("h1",{class:"text-xl font-bold"},"Review Application",-1)),e("div",ut,[e("div",null,[a(t(rt),null,{default:x(({data:s})=>[e("p",dt,[o[3]||(o[3]=G(" Application deadline: ",-1)),s.applicationsClosedAt?(i(),c("b",_t,S(t(H)(s.applicationsClosedAt,"MMMM DD, YYYY")),1)):f("",!0)])]),_:1})]),e("div",null,[a(k,{label:"Print",icon:"lucide:printer",color:"neutral",variant:"outline",size:"sm",onClick:t(m)?.print},null,8,["onClick"])])]),t(d).length?(i(),c("div",ft,[a(E,null,{content:x(()=>[e("div",yt,[e("ul",gt,[(i(!0),c(J,null,Q(t(d),s=>(i(),c("li",{key:`${s.code}-${s.path}`,class:"border-b border-b-default py-1.5"},S(s.message),1))),128))])])]),default:x(()=>[a(B,{title:`Found ${t(d).length} ${t(d).length===1?"error":"errors"}`,color:"error",variant:"subtle",orientation:"horizontal",actions:[{label:"View",color:"error"}]},null,8,["title"])]),_:1})])):f("",!0)]),e("section",bt,[t(v)?(i(),c("div",vt,[a(I,{message:("normalizeException"in g?g.normalizeException:t(P))(t(v)).message,"show-retry":"",onRetry:t(p)},null,8,["message","onRetry"])])):t(r)?(i(),c("div",xt,[a(F,{ref_key:"viewer",ref:m,"application-id":t(n)},null,8,["application-id"])])):f("",!0)]),e("div",null,[e("div",ht,[t(r)?.status==="pending"?(i(),h(A,{key:0,modelValue:t(l),"onUpdate:modelValue":o[0]||(o[0]=s=>$(l)?l.value=s:null)},null,8,["modelValue"])):(i(),h(A,{key:1,"default-value":!0,disabled:""})),o[5]||(o[5]=e("p",{class:"text-sm text-muted"}," I hereby consent that the information provided in this application by me is, to the best of my knowledge, correct and free of errors. I also consent to my application being withdrawn if it is discovered that I have willfully provided wrong or misleading information. ",-1))])]),t(r)?(i(),c("footer",wt,[a(k,{to:`/application/portal/${t(n)}/documents`,label:"Previous",color:"neutral",variant:"soft"},null,8,["to"]),e("div",kt,[t(r).hasPaidAdmissionFee?f("",!0):(i(),h(R,{key:0,"application-id":t(n),onRemove:o[1]||(o[1]=()=>("navigateTo"in g?g.navigateTo:t(W))("/application/portal"))},null,8,["application-id"])),t(r).status==="pending"?(i(),h(T,{key:1,application:t(r),"application-id":t(n),condition:t(l),"condition-message":`Please\r
          accept the terms before submitting`,onSubmit:V},null,8,["application","application-id","condition"])):f("",!0),a(D,{open:t(_),"onUpdate:open":o[2]||(o[2]=s=>$(_)?_.value=s:null),title:"Application Submitted!"},{body:x(()=>[e("div",At,[a(z,{name:"lucide:circle-check",size:"5rem",class:"text-emerald-500"}),o[6]||(o[6]=e("p",{class:"font-semibold text-emerald-500 text-center text-lg"}," Success ",-1)),o[7]||(o[7]=e("p",{class:"text-sm text-muted text-center"}," Your application has been submitted successfully ",-1))])]),_:1},8,["open"])])])):f("",!0)])])}}});export{Xt as default};
