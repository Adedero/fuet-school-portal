import{_ as C}from"./D9TAVD05.js";import{_ as k}from"./CRVZdzxc.js";import{iW as R,iX as E,aA as $,X as A,D as T,W as N,aE as P,B as L,b7 as H,ay as F,iY as I,C as W,iZ as M,l as S,f as j,z as B,A as D,a3 as O,c as U,a as g,b,w as V,o as X,t as q,g as K}from"#entry";import{u as Y}from"./BoFo4Dkd.js";import{n as Z}from"./Zkazc4B7.js";import"./Br_2l1z2.js";import"./BrTgbP-L.js";import"./DmuB_ewQ.js";function z(e={}){const s=[];let l=-1;const t=(r=!1)=>({get(i,u,d){if(!r){const c=Reflect.get(i,u,d);if(typeof c<"u")return c;l++,s[l]=[]}return s[l].push({type:"get",key:u}),new Proxy(()=>{},t(!0))},apply(i,u,d){s[l].push({type:"apply",key:"",args:d})}});return{proxy:new Proxy(e||{},t()),stack:s}}function G(e){const s={get(l,t,r){const i=Reflect.get(l,t,r);return typeof i=="object"?new Proxy(i,s):i},apply(l,t,r){Reflect.apply(l,t,r)}};return new Proxy(e,s)}function J(e,s){s.forEach(l=>{let t=e,r=e;l.forEach(({type:i,key:u,args:d})=>{i==="get"?(r=t,t=t[u]):i==="apply"&&(t=t.call(r,...d))})})}function Q(e){return e.key||e.src||(typeof e.innerHTML=="string"?e.innerHTML:"")}const ee=["preconnect","dns-prefetch"];function te(e,s,l){const t=typeof s=="string"?{src:s}:s,r=l||{},i=Q(t),u=e._scripts?.[i];if(u)return u.setupTriggerHandler(r.trigger),u;r.beforeInit?.();const d=n=>{o.status=n,e.hooks.callHook("script:updated",_)};R.forEach(n=>{const a=n,p=typeof t[a]=="function"?t[a].bind(r.eventContext):null;t[a]=m=>{d(n==="onload"?"loaded":n==="onerror"?"error":"loading"),p?.(m)}});const c={loaded:[],error:[]},f=new Set,y=(n,a,p)=>{if(!e.ssr){if(p?.key){const m=`${p?.key}:${p.key}`;if(f.has(m))return;f.add(m)}if(c[n]){const m=c[n].push(a);return()=>c[n]?.splice(m-1,1)}return a(o.instance),()=>{}}},h=new Promise(n=>{if(e.ssr)return;const a=m=>requestAnimationFrame(()=>n(m)),p=e.hooks.hook("script:updated",({script:m})=>{const w=m.status;if(m.id===i&&(w==="loaded"||w==="error")){if(w==="loaded")if(typeof r.use=="function"){const x=r.use();x&&a(x)}else a({});else w==="error"&&n(!1);p()}})}),o={_loadPromise:h,instance:!e.ssr&&r?.use?.()||null,proxy:null,id:i,status:"awaitingLoad",remove(){return o._triggerAbortController?.abort(),o._triggerPromises=[],o._warmupEl?.dispose(),o.entry?(o.entry.dispose(),o.entry=void 0,d("removed"),delete e._scripts?.[i],!0):!1},warmup(n){const{src:a}=t,p=!a.startsWith("/")||a.startsWith("//"),m=n&&ee.includes(n);let w=a;if(!n||m&&!p)return;if(m){const v=new URL(a);w=`${v.protocol}//${v.host}`}const x={href:w,rel:n,crossorigin:typeof t.crossorigin<"u"?t.crossorigin:p?"anonymous":void 0,referrerpolicy:typeof t.referrerpolicy<"u"?t.referrerpolicy:p?"no-referrer":void 0,fetchpriority:typeof t.fetchpriority<"u"?t.fetchpriority:"low",integrity:t.integrity,as:n==="preload"?"script":void 0};return o._warmupEl=e.push({link:[x]},{head:e,tagPriority:"high"}),o._warmupEl},load(n){if(o._triggerAbortController?.abort(),o._triggerPromises=[],!o.entry){d("loading");const a={defer:!0,fetchpriority:"low"};t.src&&(t.src.startsWith("http")||t.src.startsWith("//"))&&(a.crossorigin="anonymous",a.referrerpolicy="no-referrer"),o.entry=e.push({script:[{...a,...t}]},r)}return n&&y("loaded",n),h},onLoaded(n,a){return y("loaded",n,a)},onError(n,a){return y("error",n,a)},setupTriggerHandler(n){if(o.status==="awaitingLoad")if((typeof n>"u"||n==="client")&&!e.ssr||n==="server")o.load();else if(n instanceof Promise){if(e.ssr)return;o._triggerAbortController||(o._triggerAbortController=new AbortController,o._triggerAbortPromise=new Promise(p=>{o._triggerAbortController.signal.addEventListener("abort",()=>{o._triggerAbortController=null,p()})})),o._triggerPromises=o._triggerPromises||[];const a=o._triggerPromises.push(Promise.race([n.then(p=>typeof p>"u"||p?o.load:void 0),o._triggerAbortPromise]).catch(()=>{}).then(p=>{p?.()}).finally(()=>{o._triggerPromises?.splice(a,1)}))}else typeof n=="function"&&n(o.load)},_cbs:c};h.then(n=>{n!==!1?(o.instance=n,c.loaded?.forEach(a=>a(n)),c.loaded=null):(c.error?.forEach(a=>a()),c.error=null)});const _={script:o};if(o.setupTriggerHandler(r.trigger),r.use){const{proxy:n,stack:a}=z(e.ssr?{}:r.use()||{});o.proxy=n,o.onLoaded(p=>{J(p,a),o.proxy=G(p)})}return!r.warmupStrategy&&(typeof r.trigger>"u"||r.trigger==="client")&&(r.warmupStrategy="preload"),r.warmupStrategy&&o.warmup(r.warmupStrategy),e._scripts=Object.assign(e._scripts||{},{[i]:o}),o}function re(e,s){if(!s)return;const l=(t,r)=>{if(!e._cbs[t])return r(e.instance),()=>{};let i=e._cbs[t].push(r);const u=()=>{i&&(e._cbs[t]?.splice(i-1,1),i=null)};return P(u),u};e.onLoaded=t=>l("loaded",t),e.onError=t=>l("error",t),P(()=>{e._triggerAbortController?.abort()})}function oe(e,s){const l=typeof e=="string"?{src:e}:e,t=s||{},r=t?.head||E();t.head=r;const i=$();if(t.eventContext=i,i&&typeof t.trigger>"u")t.trigger=A;else if(T(t.trigger)){const d=t.trigger;let c;t.trigger=new Promise(f=>{c=N(d,y=>{y&&f(!0)},{immediate:!0}),P(()=>f(!1),!0)}).then(f=>(c?.(),f))}r._scriptStatusWatcher=r._scriptStatusWatcher||r.hooks.hook("script:updated",({script:d})=>{d._statusRef.value=d.status});const u=te(r,l,t);return u._statusRef=u._statusRef||L(u.status),re(u,i),new Proxy(u,{get(d,c,f){return Reflect.get(d,c==="status"?"_statusRef":c,f)}})}function se(){return S().public["nuxt-scripts"]}function ne(e){return e.key||e.src||(typeof e.innerHTML=="string"?e.innerHTML:"")}function ie(e,s){e=typeof e=="string"?{src:e}:e,s=H(s,se()?.defaultScriptOptions);const l=String(ne(e)),t=F();if(s.head=s.head||I(),!s.head)throw new Error("useScript() has been called without Nuxt context.");t.$scripts=t.$scripts||W({}),t.$scripts?.[l],(s.trigger==="onNuxtReady"||s.trigger==="client")&&(s.warmupStrategy||(s.warmupStrategy="preload"),s.trigger==="onNuxtReady"&&(s.trigger=M));const r=oe(e,s),i=r.remove;return r.remove=()=>(t.$scripts[l]=void 0,i()),t.$scripts[l]=r,r}let ae=e=>crypto.getRandomValues(new Uint8Array(e)),ce=(e,s,l)=>{let t=(2<<Math.log2(e.length-1))-1,r=-~(1.6*t*s/e.length);return(i=s)=>{let u="";for(;;){let d=l(r),c=r|0;for(;c--;)if(u+=e[d[c]&t]||"",u.length>=i)return u}}},le=(e,s=21)=>ce(e,s|0,ae);const ue=()=>{const e=le("1234567890ABCDEFGHIJKLMNOPQRSTUVWXYZ");return`TXN-${Date.now()}-${e(12)}`};function de(){const e=S();ie("https://newwebpay.interswitchng.com/inline-checkout.js",{tagPosition:"bodyClose"});function s(l){const{amount:t,currencyISOCode:r=566,customerEmail:i,redirectUrl:u=`${window.location.origin}${window.location.pathname}`}=l;return new Promise((d,c)=>{const f={pay_item_id:e.public.interswitch.admissionFeeItemId,pay_item_name:e.public.interswitch.admissionFeeItemName,txn_ref:ue(),amount:t,currency:r,cust_email:i,mode:"TEST",merchant_code:e.public.interswitch.merchantCode,site_redirect_url:u,onComplete:y=>{d(y)}};window.webpayCheckout||c(new Error("Interswitch WebPay Checkout is not enabled."));try{window.webpayCheckout(f)}catch(y){c(y)}})}return{checkout:s}}const fe={class:"w-full"},pe={class:"lg:max-w-[70%] mx-auto"},me={class:"my-5"},ge={class:"flex items-baseline gap-2.5 justify-between"},ye={class:"text-2xl font-semibold"},he={class:"flex items-end gap-2.5 justify-between"},ke=j({__name:"index",setup(e){const s=S(),l=B(),{checkout:t}=de(),r=D(),i=O("app-settings"),{applicationId:u=""}=Y(),d=async()=>{try{const c=l.user.value?.email;if(!c)throw new Error("Log in session expired. Please, log in to conitnue");const f=await i.value?.getSettings();if(!f?.value)throw new Error("Something happened and we're working on it. Please, try again later");const y=(f.value.admissionFee??0)*100,h=await t({customerEmail:c,amount:1e3}),{transactionStatus:o,response:_}=await $fetch(`/api/users/applicant/applications/${u}/process-admission-fee`,{method:"POST",body:{merchantCode:s.public.interswitch.merchantCode,transactionRef:h.txnref,amount:h.amount}});if(o==="failed")throw new Error(`Transaction failed with response: ${_}`);r.add({color:o==="successful"?"success":"warning",title:o==="successful"?"Success":"Pending",description:`Transaction is ${o}: ${_}`})}catch(c){r.add({color:"error",title:"Error",description:Z(c).message})}};return(c,f)=>{const y=C,h=k,o=K;return X(),U("div",fe,[g("div",pe,[f[2]||(f[2]=g("header",null,[g("h1",{class:"text-xl font-bold"},"Admission Fees Payment")],-1)),g("section",me,[g("div",null,[g("div",ge,[f[0]||(f[0]=g("p",null,"Total",-1)),b(y,{ref:"app-settings"},{default:V(({data:_})=>[g("p",ye," â‚¦ "+q(_.admissionFee?.toLocaleString()),1)]),_:1},512)])]),b(h,{class:"mt-1 mb-5"}),g("div",null,[g("div",he,[f[1]||(f[1]=g("div",null,[g("p",{class:"font-semibold"},"Admission Fees"),g("p",{class:"text-sm text-muted"}," Paid on September 24, 2025 06:50 a.m | Unpaid ")],-1)),g("div",null,[b(o,{label:"Download Receipt",icon:"lucide:download",color:"neutral",variant:"outline",class:"hidden"}),b(o,{label:"Pay Now",icon:"lucide-credit-card","loading-auto":"",onClick:d})])])])])])])}}});export{ke as default};
