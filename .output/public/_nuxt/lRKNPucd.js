import{f as k,y as L,A as $,c as r,Q as x,k as t,o as n,b as a,g as z,ai as U,K as q,j as h,a as e,m as F,n as J,P as Q,ac as G,w as b,i as w,J as C,s as H,d as W,t as E,q as X,F as Z,r as tt,E as et}from"#entry";import{_ as ot}from"./DrzXPWwZ.js";import{_ as nt}from"./CW3OX1Zc.js";import{_ as I}from"./BtPAQVJY.js";import{_ as it}from"./DiDntUOY.js";import{_ as st}from"./DoiJs5pB.js";import{_ as at}from"./CtTfiUAN.js";import{a as M}from"./D_V8B0H9.js";import{n as A}from"./Zkazc4B7.js";import{u as rt}from"./DGAGqVya.js";import{u as P}from"./Dd6P5Vqf.js";import"./CuGSGFmI.js";import"./CAoX7tgf.js";import"./DGOa__Ri.js";import"./DFpZvX7f.js";import"./DY9up4i8.js";import"./ByYrLWxT.js";import"./CuPKMK4g.js";import"./BzoIj2I_.js";import"./pGuP4G4E.js";import"./DV6tVSyL.js";import"./CG7Kytdp.js";import"./CT8naASD.js";import"./CrQKmWKl.js";import"./PZTdxXR1.js";import"./BnhhJy-q.js";const lt=k({__name:"submitter",props:{application:{},condition:{type:Boolean,default:!0},conditionMessage:{default:""},applicationId:{}},emits:["submit"],setup(f,{emit:m}){const u=m,i=L(),{confirmAsync:l}=U(),g=async()=>await l({title:"Submit Application",description:"Are you sure you want to submit this application? Once submitted, you cannot edit any part of the application"}),s=$(!1);async function _(){if(!f.condition){i.add({color:"error",title:"Error",description:f.conditionMessage});return}const c=M.safeParse(f.application);if(!c.success){i.add({color:"error",title:"Error",description:c.error.issues[0]?.message??"Some fields are missing. Check your applictaion and try again."});return}if(await g()){s.value=!0;try{const d=await $fetch(`/api/users/applicant/applications/${f.applicationId}/submit`,{method:"POST"});u("submit"),i.add({color:"success",title:"Success",description:d.message})}catch(d){i.add({color:"error",title:"Error",description:A(d).message})}finally{s.value=!1}}}return(c,d)=>{const y=z;return n(),r("div",{onClick:_},[x(c.$slots,"default",{loading:t(s)},()=>[a(y,{label:"Submit",loading:t(s)},null,8,["loading"])])])}}}),ct=Object.assign(lt,{__name:"ApplicationSubmitter"}),pt={key:0},mt={class:"flex-center"},dt={key:1},ut={key:2},_t=k({__name:"settings",setup(f){const{data:m,error:u,pending:i,refresh:l,execute:g}=P("/api/general/settings",{},"$BCIsi-YFc7");return q(async()=>{await g()}),(s,_)=>{const c=F,d=I;return n(),r("div",null,[t(i)?(n(),r("div",pt,[x(s.$slots,"loading",{loading:t(i)},()=>[e("div",mt,[a(c,{name:"lucide:loader",size:"2rem",class:"text-muted animate animate-spin"})])])])):t(u)?(n(),r("div",dt,[x(s.$slots,"error",{error:("normalizeException"in s?s.normalizeException:t(A))(t(u)),refresh:t(l)},()=>[a(d,{message:"Failed to get settings","show-retry":"",onRetry:t(l)},null,8,["onRetry"])])])):t(m)?(n(),r("div",ut,[x(s.$slots,"default",{data:t(m)})])):h("",!0)])}}}),ft=Object.assign(_t,{__name:"AppSettings"}),gt={class:"w-full"},yt={class:"lg:max-w-[80%] mx-auto"},ht={class:"mt-1 flex items-center gap-2.5 justify-between"},vt={class:"text-sm"},bt={key:0},xt={key:0,class:"mt-2"},wt={class:"p-5 space-y-5 max-w-80 max-h-[26rem] overflow-y-auto"},$t={class:"grid gap-2 list-inside list-disc"},kt={class:"my-5"},At={key:0},St={key:1},Nt={class:"flex items-start gap-2"},Ct={key:0,class:"mt-5 flex items-center gap-2.5 justify-between"},Et={class:"flex items-center justify-end gap-2.5"},zt={class:"flex-col-center gap-2.5"},ne=k({__name:"index",async setup(f){let m,u;const{applicationId:i=""}=rt(),{data:l,error:g,refresh:s}=([m,u]=J(()=>P(`/api/users/applicant/applications/${i}`,"$NMKLN2r7Ah")),m=await m,u(),m),_=Q(()=>M.safeParse(l.value??{}).error?.issues??[]),c=$(!1),d=G("viewer"),y=$(!1),R=()=>{y.value=!0,s()};return(v,o)=>{const S=z,V=ot,B=nt,T=I,j=it,N=st,Y=at,D=ct,O=F,K=H;return n(),r("div",gt,[e("div",yt,[e("header",null,[o[4]||(o[4]=e("h1",{class:"text-xl font-bold"},"Review Application",-1)),e("div",ht,[e("div",null,[a(t(ft),null,{default:b(({data:p})=>[e("p",vt,[o[3]||(o[3]=W(" Application deadline: ",-1)),p.applicationsClosedAt?(n(),r("b",bt,E(t(X)(p.applicationsClosedAt,"MMMM DD, YYYY")),1)):h("",!0)])]),_:1})]),e("div",null,[a(S,{label:"Print",icon:"lucide:printer",color:"neutral",variant:"outline",size:"sm",onClick:t(d)?.print},null,8,["onClick"])])]),t(_).length?(n(),r("div",xt,[a(B,null,{content:b(()=>[e("div",wt,[e("ul",$t,[(n(!0),r(Z,null,tt(t(_),p=>(n(),r("li",{key:`${p.code}-${p.path}`,class:"border-b border-b-default py-1.5"},E(p.message),1))),128))])])]),default:b(()=>[a(V,{title:`Found ${t(_).length} ${t(_).length===1?"error":"errors"}`,color:"error",variant:"subtle",orientation:"horizontal",actions:[{label:"View",color:"error"}]},null,8,["title"])]),_:1})])):h("",!0)]),e("section",kt,[t(g)?(n(),r("div",At,[a(T,{message:("normalizeException"in v?v.normalizeException:t(A))(t(g)).message,"show-retry":"",onRetry:t(s)},null,8,["message","onRetry"])])):t(l)?(n(),r("div",St,[a(j,{ref_key:"viewer",ref:d,"application-id":t(i)},null,8,["application-id"])])):h("",!0)]),e("div",null,[e("div",Nt,[t(l)?.status==="pending"?(n(),w(N,{key:0,modelValue:t(c),"onUpdate:modelValue":o[0]||(o[0]=p=>C(c)?c.value=p:null)},null,8,["modelValue"])):(n(),w(N,{key:1,"default-value":!0,disabled:""})),o[5]||(o[5]=e("p",{class:"text-sm text-muted"}," I hereby consent that the information provided in this application by me is, to the best of my knowledge, correct and free of errors. I also consent to my application being withdrawn if it is discovered that I have willfully provided wrong or misleading information. ",-1))])]),t(l)?(n(),r("footer",Ct,[a(S,{to:`/application/portal/${t(i)}/documents`,label:"Previous",color:"neutral",variant:"soft"},null,8,["to"]),e("div",Et,[a(Y,{"application-id":t(i),onRemove:o[1]||(o[1]=()=>("navigateTo"in v?v.navigateTo:t(et))("/application/portal"))},null,8,["application-id"]),t(l).status==="pending"?(n(),w(D,{key:0,application:t(l),"application-id":t(i),condition:t(c),"condition-message":`Please
          accept the terms before submitting`,onSubmit:R},null,8,["application","application-id","condition"])):h("",!0),a(K,{open:t(y),"onUpdate:open":o[2]||(o[2]=p=>C(y)?y.value=p:null),title:"Application Submitted!"},{body:b(()=>[e("div",zt,[a(O,{name:"lucide:circle-check",size:"5rem",class:"text-emerald-500"}),o[6]||(o[6]=e("p",{class:"font-semibold text-emerald-500 text-center text-lg"}," Success ",-1)),o[7]||(o[7]=e("p",{class:"text-sm text-muted text-center"}," Your application has been submitted successfully ",-1))])]),_:1},8,["open"])])])):h("",!0)])])}}});export{ne as default};
