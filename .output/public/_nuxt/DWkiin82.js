import{_ as k}from"./Br_2l1z2.js";import{_ as y}from"./CdUQPPYw.js";import{_ as S,a as C}from"./CfG1-w7I.js";import{f as V,z,C as B,B as _,c as f,j as $,b as t,k as n,w as o,E as F,D as U,x as j,o as p,g as A,d as I,a as d,G as M}from"#entry";import{n as R}from"./Zkazc4B7.js";import{z as w}from"./ChM03Ocf.js";const D={key:0,class:"mb-3"},O=V({__name:"change-email-form",setup(G){const r=z(),E=w.object({newEmail:w.email("Invalid email address")}),a=B({newEmail:""});function b(){a.newEmail=""}const s=_(null),l=_(!1);async function g(c){s.value=null;const{newEmail:e}=c.data;await M.changeEmail({newEmail:e,callbackURL:"/login"},{onError(i){s.value=R(i.error)},onSuccess(){b(),l.value=!0,r.setUser(null),r.setSession(null)}})}return(c,e)=>{const i=k,x=y,h=C,u=A,v=S,N=j;return p(),f("div",null,[n(s)?(p(),f("div",D,[t(i,{message:n(s).message},null,8,["message"])])):$("",!0),t(v,{schema:n(E),state:n(a),class:"space-y-4",onSubmit:F(g,["prevent"])},{default:o(()=>[t(h,{label:"New Email",name:"newEmail"},{default:o(()=>[t(x,{modelValue:n(a).newEmail,"onUpdate:modelValue":e[0]||(e[0]=m=>n(a).newEmail=m),size:"lg",class:"w-full"},null,8,["modelValue"])]),_:1}),t(u,{type:"submit",class:"mt-2 w-full flex-center",size:"lg",icon:"i-lucide:check-circle","loading-auto":""},{default:o(()=>[...e[2]||(e[2]=[I(" Submit ",-1)])]),_:1})]),_:1},8,["schema","state"]),t(N,{open:n(l),"onUpdate:open":e[1]||(e[1]=m=>U(l)?l.value=m:null),title:"Success",close:!1,dismissible:!1,ui:{footer:"justify-end"}},{body:o(()=>[...e[3]||(e[3]=[d("div",{class:"space-y-3"},[d("p",null," Click the link that has been sent to your current email to continue ")],-1)])]),footer:o(()=>[t(u,{to:"/login",label:"Continue","trailing-icon":"lucide:circle-arrow-right"})]),_:1},8,["open"])])}}});export{O as _};
