import{_ as z}from"./ny5Wg1iX.js";import{f as A,y as $,A as C,c as g,o as l,a as o,b as n,Q as j,w as f,g as w,k as e,J as N,s as E,n as M,ac as F,i as h,j as y,d as O,t as U,E as G,ai as J}from"#entry";import{n as k}from"./Zkazc4B7.js";import{_ as L}from"./BzoIj2I_.js";import{_ as Q}from"./CW3OX1Zc.js";import{_ as W}from"./BtPAQVJY.js";import{_ as q}from"./DiDntUOY.js";import{u as H}from"./DGAGqVya.js";import{u as K}from"./Dd6P5Vqf.js";import"./CuGSGFmI.js";import"./CAoX7tgf.js";import"./DGOa__Ri.js";import"./DFpZvX7f.js";import"./DY9up4i8.js";import"./ByYrLWxT.js";import"./DrzXPWwZ.js";import"./CuPKMK4g.js";import"./pGuP4G4E.js";const X={class:"flex items-center justify-end gap-2.5"},Y=A({__name:"accepter",props:{applicationId:{}},emits:["done"],setup(b,{emit:p}){const m=p,d=$(),s=C(!1);async function u(){try{const{message:t}=await $fetch(`/api/users/admin/applications/${b.applicationId}/update-status`,{method:"post",body:{status:"accepted"}});m("done"),s.value=!1,d.add({color:"success",title:"Success",description:t})}catch(t){d.add({color:"error",title:"Error",description:k(t).message})}}return(t,i)=>{const r=w,_=E;return l(),g("div",null,[o("div",{onClick:i[0]||(i[0]=a=>s.value=!0)},[j(t.$slots,"default")]),n(_,{open:e(s),"onUpdate:open":i[1]||(i[1]=a=>N(s)?s.value=a:null),title:"Accept Application",description:"Are you sure you want to accept this application?",dismissible:!1,close:!1},{body:f(({close:a})=>[o("div",null,[o("div",X,[n(r,{label:"Cancel",color:"neutral",variant:"soft",onClick:a},null,8,["onClick"]),n(r,{label:"Proceed","loading-auto":"",onClick:u})])])]),_:1},8,["open"])])}}}),Z=Object.assign(Y,{__name:"ApplicationAccepter"}),tt={class:"flex items-center justify-end gap-2.5"},et=A({__name:"rejecter",props:{applicationId:{}},emits:["done"],setup(b,{emit:p}){const m=p,d=$(),s=C(!1);async function u(){try{const{message:t}=await $fetch(`/api/users/admin/applications/${b.applicationId}/update-status`,{method:"post",body:{status:"rejected"}});m("done"),s.value=!1,d.add({color:"success",title:"Success",description:t})}catch(t){d.add({color:"error",title:"Error",description:k(t).message})}}return(t,i)=>{const r=w,_=E;return l(),g("div",null,[o("div",{onClick:i[0]||(i[0]=a=>s.value=!0)},[j(t.$slots,"default")]),n(_,{open:e(s),"onUpdate:open":i[1]||(i[1]=a=>N(s)?s.value=a:null),title:"Accept Application",description:"Are you sure you want to reject this application?",dismissible:!1,close:!1},{body:f(({close:a})=>[o("div",null,[o("div",tt,[n(r,{label:"Cancel",color:"neutral",variant:"soft",onClick:a},null,8,["onClick"]),n(r,{label:"Proceed","loading-auto":"",onClick:u})])])]),_:1},8,["open"])])}}}),ot=Object.assign(et,{__name:"ApplicationRejecter"}),nt={class:"p-5"},st={class:"flex items-center gap-5 justify-between"},it={class:"flex items-center gap-2"},at={class:"text-lg font-bold"},ct={class:"mb-5 flex items-center justify-end gap-2.5"},rt={class:"p-5"},lt={class:"w-40 grid gap-1"},pt={class:"mt-5"},dt={key:0},ut={key:1},Dt=A({__name:"index",async setup(b){let p,m;const d=$(),{confirmAsync:s}=J(),{applicationId:u=""}=H(),{data:t,error:i,refresh:r}=([p,m]=M(()=>K(`/api/users/admin/applications/${u}`,"$d99B_tMvGW")),p=await p,m(),p),_=F("viewer"),a={pending:"secondary",submitted:"warning",accepted:"success",rejected:"error"},B=async()=>{if(await(async()=>await s({title:"Delete Application",description:"Are you sure you want to delete this application? This action cannot be undone",acceptProps:{color:"error",label:"Delete"}}))())try{const{message:c}=await $fetch(`/api/users/admin/applications/${u}`,{method:"DELETE"});G("/portal/admin/applications"),d.add({color:"success",title:"Success",description:c})}catch(c){d.add({color:"error",title:"Error",description:k(c).message})}};return(x,c)=>{const D=z,v=w,R=Z,P=ot,S=L,T=Q,I=W,V=q;return l(),g("div",nt,[o("header",null,[o("div",st,[o("div",it,[o("h1",at,[c[2]||(c[2]=O(" Application ",-1)),o("b",null,U(e(t)?.applicationNumber),1)]),e(t)?(l(),h(D,{key:0,label:e(t).status,color:a[e(t).status],variant:"subtle"},null,8,["label","color"])):y("",!0)]),o("div",ct,[n(v,{label:"Print",icon:"lucide:printer",color:"neutral",variant:"outline",onClick:e(_)?.print},null,8,["onClick"]),e(t)?(l(),h(T,{key:0},{content:f(()=>[o("div",rt,[o("div",lt,[e(t).status==="pending"||e(t).status==="rejected"?(l(),h(R,{key:0,"application-id":e(u),onDone:c[0]||(c[0]=()=>e(r)())},{default:f(()=>[n(v,{label:"Accept",color:"neutral",variant:"ghost","trailing-icon":"lucide:circle-check",block:""})]),_:1},8,["application-id"])):y("",!0),e(t).status==="pending"||e(t).status==="accepted"?(l(),h(P,{key:1,"application-id":e(u),onDone:c[1]||(c[1]=()=>e(r)())},{default:f(()=>[n(v,{label:"Reject",color:"neutral",variant:"ghost","trailing-icon":"lucide:circle-x",block:""})]),_:1},8,["application-id"])):y("",!0),n(S),n(v,{label:"Delete",color:"error",variant:"ghost","trailing-icon":"lucide:trash-2",block:"","loading-auto":"",onClick:B})])])]),default:f(()=>[n(v,{icon:"lucide:ellipsis-vertical",color:"neutral",variant:"outline"})]),_:1})):y("",!0)])])]),o("section",pt,[e(i)?(l(),g("div",dt,[n(I,{message:("normalizeException"in x?x.normalizeException:e(k))(e(i)).message,"show-retry":"",onRetry:e(r)},null,8,["message","onRetry"])])):e(t)?(l(),g("div",ut,[o("div",null,[n(V,{ref_key:"viewer",ref:_,"application-id":e(t).id},null,8,["application-id"])])])):y("",!0)])])}}});export{Dt as default};
