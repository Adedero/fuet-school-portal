import{_ as Q}from"./D8n4x_QM.js";import{f as w,A as S,B as V,c as N,o as p,a as l,b as t,O as P,w as r,g as R,k as e,D as I,x as j,C as X,M as U,a2 as D,i as A,j as C,Y as Z,a1 as ee,W as te,E as ne,s as oe,a3 as ae,d as se,t as ie,I as le,io as re}from"#entry";import{n as k}from"./Zkazc4B7.js";import{_ as ce}from"./CRVZdzxc.js";import{_ as ue}from"./XC2qsoqq.js";import{_ as q}from"./Br_2l1z2.js";import{_ as de}from"./BrTgbP-L.js";import{_ as pe}from"./BxE-QSiJ.js";import{_ as M,a as B}from"./2EICDMI2.js";import{_ as z}from"./iSq_GXOF.js";import{z as v}from"./CQ9DD0Tp.js";import{_ as me}from"./fc9N2lAZ.js";import{u as T}from"./DmuB_ewQ.js";import{_ as _e}from"./VgBGaiWr.js";import{_ as fe}from"./7RKIiw9z.js";import{u as be}from"./BoFo4Dkd.js";import"./C349kGaG.js";import"./CZ9GQ99X.js";import"./Dx-2vZsd.js";import"./Cp9dvClo.js";import"./fgKd3tbi.js";import"./DX__6iYn.js";import"./jFYhBC76.js";import"./BePoOrxp.js";import"./3OEFcGef.js";import"./BZPIhiCP.js";import"./DOVLR_vN.js";import"./CuPKMK4g.js";import"./CSucrOrG.js";const ge={class:"flex items-center justify-end gap-2.5"},ve=w({__name:"accepter",props:{applicationId:{}},emits:["done"],setup(f,{emit:u}){const m=u,a=S(),i=V(!1);async function _(){try{const{message:n}=await $fetch(`/api/users/admin/applications/${f.applicationId}/update-status`,{method:"post",body:{status:"accepted"}});m("done"),i.value=!1,a.add({color:"success",title:"Success",description:n})}catch(n){a.add({color:"error",title:"Error",description:k(n).message})}}return(n,o)=>{const s=R,d=j;return p(),N("div",null,[l("div",{onClick:o[0]||(o[0]=c=>i.value=!0)},[P(n.$slots,"default")]),t(d,{open:e(i),"onUpdate:open":o[1]||(o[1]=c=>I(i)?i.value=c:null),title:"Accept Application",description:"Are you sure you want to accept this application?",dismissible:!1,close:!1},{body:r(({close:c})=>[l("div",null,[l("div",ge,[t(s,{label:"Cancel",color:"neutral",variant:"soft",onClick:c},null,8,["onClick"]),t(s,{label:"Proceed","loading-auto":"",onClick:_})])])]),_:1},8,["open"])])}}}),ye=Object.assign(ve,{__name:"ApplicationAccepter"}),Ne={class:"flex items-center justify-end gap-2.5"},xe=w({__name:"rejecter",props:{applicationId:{}},emits:["done"],setup(f,{emit:u}){const m=u,a=S(),i=V(!1);async function _(){try{const{message:n}=await $fetch(`/api/users/admin/applications/${f.applicationId}/update-status`,{method:"post",body:{status:"rejected"}});m("done"),i.value=!1,a.add({color:"success",title:"Success",description:n})}catch(n){a.add({color:"error",title:"Error",description:k(n).message})}}return(n,o)=>{const s=R,d=j;return p(),N("div",null,[l("div",{onClick:o[0]||(o[0]=c=>i.value=!0)},[P(n.$slots,"default")]),t(d,{open:e(i),"onUpdate:open":o[1]||(o[1]=c=>I(i)?i.value=c:null),title:"Accept Application",description:"Are you sure you want to reject this application?",dismissible:!1,close:!1},{body:r(({close:c})=>[l("div",null,[l("div",Ne,[t(s,{label:"Cancel",color:"neutral",variant:"soft",onClick:c},null,8,["onClick"]),t(s,{label:"Proceed","loading-auto":"",onClick:_})])])]),_:1},8,["open"])])}}}),Ae=Object.assign(xe,{__name:"ApplicationRejecter"}),$e={class:"mb-10"},he={class:"grid gap-2.5 md:grid-cols-2"},Ce={class:"mb-5"},ke={class:"grid gap-2.5 md:grid-cols-2"},we=w({__name:"student-payment-creator",props:{applicationId:{}},setup(f){const u=S(),m=v.object({amount:v.number().gt(0),transactionRef:v.string().nonempty(),paymentRef:v.string().nonempty(),regNumber:v.string().nonempty(),studentClassName:v.string().nonempty(),departmentName:v.string().nonempty()}),a=X({amount:0,transactionRef:"",paymentRef:"",regNumber:"",studentClassName:"",departmentName:""}),i=async _=>{try{const{message:n}=await $fetch(`/api/users/admin/applications/${f.applicationId}/create-payment-and-student`,{method:"POST",body:_.data});u.add({color:"success",title:"Success",description:n})}catch(n){u.add({color:"error",title:"Error",description:k(n).message})}};return(_,n)=>{const o=pe,s=B,d=z,c=R,x=M,$=j;return p(),N("div",null,[t($,{title:"Create Student Account"},{body:r(()=>[l("div",null,[t(x,{state:e(a),schema:e(m),onSubmit:i},{default:r(()=>[l("div",$e,[n[6]||(n[6]=l("p",{class:"mb-2 text-muted text-sm font-semibold"}," Admission Fee Payment ",-1)),l("div",he,[t(s,{name:"amount",label:"Amount",required:""},{default:r(()=>[t(o,{modelValue:e(a).amount,"onUpdate:modelValue":n[0]||(n[0]=b=>e(a).amount=b),orientation:"vertical",class:"w-full"},null,8,["modelValue"])]),_:1}),t(s,{name:"transactionRef",label:"Transaction Ref",required:""},{default:r(()=>[t(d,{modelValue:e(a).transactionRef,"onUpdate:modelValue":n[1]||(n[1]=b=>e(a).transactionRef=b),class:"w-full"},null,8,["modelValue"])]),_:1}),t(s,{name:"paymentRef",label:"Payment Ref",required:""},{default:r(()=>[t(d,{modelValue:e(a).paymentRef,"onUpdate:modelValue":n[2]||(n[2]=b=>e(a).paymentRef=b),class:"w-full"},null,8,["modelValue"])]),_:1})])]),l("div",Ce,[n[7]||(n[7]=l("p",{class:"mb-2 text-muted text-sm font-semibold"},"Student Info",-1)),l("div",ke,[t(s,{name:"regNumber",label:"Reg. Number",required:""},{default:r(()=>[t(d,{modelValue:e(a).regNumber,"onUpdate:modelValue":n[3]||(n[3]=b=>e(a).regNumber=b),class:"w-full"},null,8,["modelValue"])]),_:1}),t(s,{name:"studentClassName",label:"Class Name",required:""},{default:r(()=>[t(d,{modelValue:e(a).studentClassName,"onUpdate:modelValue":n[4]||(n[4]=b=>e(a).studentClassName=b),class:"w-full"},null,8,["modelValue"])]),_:1}),t(s,{name:"departmentName",label:"Department",required:""},{default:r(()=>[t(d,{modelValue:e(a).departmentName,"onUpdate:modelValue":n[5]||(n[5]=b=>e(a).departmentName=b),class:"w-full"},null,8,["modelValue"])]),_:1})])]),l("div",null,[t(c,{type:"submit",label:"Submit"})])]),_:1},8,["state","schema"])])]),default:r(()=>[P(_.$slots,"default")]),_:3})])}}}),Ve=Object.assign(we,{__name:"AdminStudentPaymentCreator"}),Se=w({__name:"student-class-select",props:{modelValue:{default:void 0},modelModifiers:{}},emits:["update:modelValue"],setup(f){const{data:u,error:m,status:a,execute:i}=T("/api/general/student-classes",{lazy:!0},"$Up6cE9ckJh"),_=U(()=>a.value==="pending"),n=U(()=>(u.value??[]).map(s=>s.className)),o=D(f,"modelValue");return(s,d)=>{const c=me,x=q;return p(),N("div",null,[e(_)||e(u)?(p(),A(c,Z({key:0,modelValue:o.value,"onUpdate:modelValue":d[0]||(d[0]=$=>o.value=$),items:e(n),loading:e(_)},s.$attrs),null,16,["modelValue","items","loading"])):e(m)?(p(),A(x,{key:1,message:"Failed to get student classes","show-retry":"",onRetry:e(i)},null,8,["onRetry"])):C("",!0)])}}}),Re=Object.assign(Se,{__name:"AppStudentClassSelect"}),Ie=v.object({applicationId:v.string("Invalid application ID").nonempty("Application ID is required"),regNumber:v.string("Invalid registration number").nonempty("Registration number is required"),studentClass:v.string("Invalid student class").nonempty("Student class is required"),department:v.string("Invalid department").nonempty("Department is required")});function je(f,u){const m=f.split("/");if(m.length!==3)return"";const a=m[1],i=m[2];return`FUET/${u}/${a}/${i}`}const Ee={class:"flex items-center gap-2 justify-end"},Fe=w({__name:"creator",props:ee({application:{}},{open:{type:Boolean},openModifiers:{}}),emits:["update:open"],setup(f){const u=S(),m=D(f,"open"),a=V({applicationId:f.application.id}),i=V(f.application.course?{label:f.application.course,value:"",faculty:""}:void 0);te(i,o=>a.value.department=o?.label);const _=()=>{if(!i.value?.value){u.add({color:"error",title:"Error",description:"Please select a department first"});return}const o=je(f.application.applicationNumber,i.value.value);a.value.regNumber=o},n=async o=>{try{const{message:s}=await $fetch(`/api/users/admin/applications/${f.application.id}/create-student`,{method:"POST",body:o.data});m.value=!1,a.value={},u.add({color:"success",title:"Success",description:s})}catch(s){u.add({color:"error",title:"Error",description:k(s).message})}};return(o,s)=>{const d=z,c=B,x=R,$=Re,b=_e,g=M,E=j;return p(),A(E,{open:m.value,"onUpdate:open":s[3]||(s[3]=y=>m.value=y),title:"Add Student",dismissible:!1},{body:r(({close:y})=>[l("div",null,[t(g,{state:e(a),schema:e(Ie),class:"grid gap-5",onSubmit:ne(n,["prevent"])},{default:r(()=>[t(c,{label:"Application ID",required:""},{default:r(()=>[t(d,{value:e(a).applicationId,disabled:"",size:"lg",class:"w-full"},null,8,["value"])]),_:1}),t(c,{name:"regNumber",label:"Registration/Matric Number",class:"relative",required:""},{default:r(()=>[t(d,{modelValue:e(a).regNumber,"onUpdate:modelValue":s[0]||(s[0]=h=>e(a).regNumber=h),size:"lg",class:"w-full"},null,8,["modelValue"]),t(x,{label:"generate","trailing-icon":"lucide:wand-sparkles",variant:"ghost",size:"sm",class:"absolute -top-7 right-0",onClick:_})]),_:1}),t(c,{name:"studentClass",label:"Student's Class",required:""},{default:r(()=>[t($,{modelValue:e(a).studentClass,"onUpdate:modelValue":s[1]||(s[1]=h=>e(a).studentClass=h),size:"lg",class:"w-full"},null,8,["modelValue"])]),_:1}),t(c,{name:"department",label:"Department",required:""},{default:r(()=>[t(b,{department:e(i),"onUpdate:department":s[2]||(s[2]=h=>I(i)?i.value=h:null),item:"department",size:"lg",class:"w-full"},null,8,["department"])]),_:1}),l("div",Ee,[t(x,{type:"button",label:"Cancel",color:"neutral",variant:"soft",onClick:y},null,8,["onClick"]),t(x,{type:"submit",label:"Submit","loading-auto":""})])]),_:2},1032,["state","schema"])])]),_:1},8,["open"])}}}),Pe=Object.assign(Fe,{__name:"AdminStudentsCreator"}),Ue={class:"p-5"},De={class:"flex items-center gap-5 justify-between"},qe={class:"flex items-center gap-2"},Me={class:"text-lg font-bold"},Be={class:"mb-5 flex items-center justify-end gap-2.5"},ze={class:"p-5"},Te={class:"w-40 grid gap-1"},Oe={class:"mt-5"},We={key:0},Ge={key:1},Je={key:0,class:"mb-5"},Le={key:0},Ye={key:1,class:"space-y-5"},ht=w({__name:"index",async setup(f){let u,m;const a=S(),{confirmAsync:i}=re(),_=V(!1),{applicationId:n=""}=be(),{data:o,error:s,refresh:d}=([u,m]=oe(()=>T(`/api/users/admin/applications/${n}`,"$d99B_tMvGW")),u=await u,m(),u),c=ae("viewer"),x={pending:"secondary",submitted:"warning",accepted:"success",rejected:"error"},$=async()=>{if(await(async()=>await i({title:"Delete Application",description:"Are you sure you want to delete this application? This action cannot be undone",acceptProps:{color:"error",label:"Delete"}}))())try{const{message:g}=await $fetch(`/api/users/admin/applications/${n}`,{method:"DELETE"});le("/portal/admin/applications"),a.add({color:"success",title:"Success",description:g})}catch(g){a.add({color:"error",title:"Error",description:k(g).message})}};return(b,g)=>{const E=Q,y=R,h=ye,O=Ae,W=ce,G=ue,J=q,F=de,L=Ve,Y=Pe,H=fe;return p(),N("div",Ue,[l("header",null,[l("div",De,[l("div",qe,[l("h1",Me,[g[3]||(g[3]=se(" Application ",-1)),l("b",null,ie(e(o)?.applicationNumber),1)]),e(o)?(p(),A(E,{key:0,label:e(o).status,color:x[e(o).status],variant:"subtle"},null,8,["label","color"])):C("",!0)]),l("div",Be,[t(y,{label:"Print",icon:"lucide:printer",color:"neutral",variant:"outline",onClick:e(c)?.print},null,8,["onClick"]),e(o)?(p(),A(G,{key:0},{content:r(()=>[l("div",ze,[l("div",Te,[e(o).status==="submitted"||e(o).status==="rejected"?(p(),A(h,{key:0,"application-id":e(n),onDone:g[0]||(g[0]=()=>e(d)())},{default:r(()=>[t(y,{label:"Accept",color:"neutral",variant:"ghost","trailing-icon":"lucide:circle-check",block:""})]),_:1},8,["application-id"])):C("",!0),e(o).status==="submitted"||e(o).status==="accepted"?(p(),A(O,{key:1,"application-id":e(n),onDone:g[1]||(g[1]=()=>e(d)())},{default:r(()=>[t(y,{label:"Reject",color:"neutral",variant:"ghost","trailing-icon":"lucide:circle-x",block:""})]),_:1},8,["application-id"])):C("",!0),t(W),t(y,{label:"Delete",color:"error",variant:"ghost","trailing-icon":"lucide:trash-2",block:"","loading-auto":"",onClick:$})])])]),default:r(()=>[t(y,{icon:"lucide:ellipsis-vertical",color:"neutral",variant:"outline"})]),_:1})):C("",!0)])])]),l("section",Oe,[e(s)?(p(),N("div",We,[t(J,{message:("normalizeException"in b?b.normalizeException:e(k))(e(s)).message,"show-retry":"",onRetry:e(d)},null,8,["message","onRetry"])])):e(o)?(p(),N("div",Ge,[e(o).status==="accepted"?(p(),N("div",Je,[e(o).hasPaidAdmissionFee&&e(o).admissionFeePaymentId?(p(),N("div",Le,[e(o).student?(p(),A(F,{key:1,title:"Admission fee",description:"Applicant has paid the admission fee and has been approved as a student",icon:"lucide:info",color:"success",variant:"subtle"})):(p(),A(F,{key:0,title:"Admission fee",description:"Applicant has paid the admission fee",icon:"lucide:info",color:"success",variant:"subtle",orientation:"horizontal",actions:[{label:"Approve",icon:"lucide:circle-check",size:"sm",onClick:()=>{_.value=!0}}]},null,8,["actions"]))])):(p(),N("div",Ye,[t(F,{title:"Admission Fee",description:"Applicant has not paid the admission fee",icon:"lucide:info",color:"warning",variant:"subtle"}),t(L,{"application-id":e(n)},{default:r(()=>[t(y,{label:"Manual Validation"})]),_:1},8,["application-id"])])),t(Y,{open:e(_),"onUpdate:open":g[2]||(g[2]=K=>I(_)?_.value=K:null),application:e(o)},null,8,["open","application"])])):C("",!0),l("div",null,[t(H,{ref_key:"viewer",ref:c,"application-id":e(o).id},null,8,["application-id"])])])):C("",!0)])])}}});export{ht as default};
