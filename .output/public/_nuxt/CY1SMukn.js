import{_ as ue}from"./Br_2l1z2.js";import{_ as ce}from"./DUGQhyV-.js";import{_ as de,a as pe}from"./CfG1-w7I.js";import{B as M,M as D,k as t,C as H,X as me,W as ee,a1 as Z,T as fe,a2 as ve,L as ge,aq as ye,U as be,N as X,c as b,o as s,b as $,w as B,j as w,F as C,O as k,a as d,P as z,r as te,Z as Y,d as O,t as P,g as L,Y as G,E as J,i as _,q as he,ag as xe,m as ae,Q as ze,f as W,A as le,av as _e,s as ke}from"#entry";import{d as we,e as $e,c as Fe}from"./D1lORq9n.js";import{d as Ue,f as Te}from"./DFsRs8ow.js";import{n as K}from"./Zkazc4B7.js";import{_ as Se}from"./RyBLt_tc.js";import{_ as Be}from"./CSucrOrG.js";import{u as qe}from"./BoFo4Dkd.js";import{u as De}from"./C1RyDYw7.js";import"./BrTgbP-L.js";import"./C7XPntmp.js";import"./DxgE_vvP.js";import"./CrxYuplo.js";import"./DD2e9X2d.js";import"./bGYnQNJU.js";import"./CdUQPPYw.js";import"./BZPIhiCP.js";import"./ChM03Ocf.js";function Re(a){if(!a||a==="*")return;const n=a.split(",").map(o=>{const e=o.trim();return e.includes("/")&&e.endsWith("/*")&&e.split("/")[0]||e}).filter(o=>!o.startsWith("."));return n.length>0?n:void 0}function Ae(a){const{accept:n="*",reset:o=!1,multiple:e=!1,dropzone:u=!0,onUpdate:h}=a,l=M(),p=M(),x=D(()=>Re(t(n))),r=c=>{!c||c.length===0||(c instanceof FileList&&(c=Array.from(c)),c.length>1&&!e&&(c=[c[0]]),h(c))},m=M(!1),T=H({open:()=>{}});function f(){T.open()}return me(()=>{const{isOverDropZone:c}=u?we(p,{dataTypes:x.value,onDrop:r}):{isOverDropZone:M(!1)};ee(c,R=>{m.value=R});const{onChange:F,open:S}=$e({accept:t(n),multiple:e,input:t(l),reset:o});T.open=S,F(R=>r(R))}),{isDragging:m,open:f,inputRef:l,dropzoneRef:p}}const Ce={slots:{root:"relative flex flex-col",base:["w-full flex-1 bg-default border border-default flex flex-col gap-2 items-stretch justify-center rounded-lg focus-visible:outline-2","transition-[background]"],wrapper:"flex flex-col items-center justify-center text-center",icon:"shrink-0",avatar:"shrink-0",label:"font-medium text-default mt-2",description:"text-muted mt-1",actions:"flex flex-wrap gap-1.5 shrink-0 mt-4",files:"",file:"relative",fileLeadingAvatar:"shrink-0",fileWrapper:"flex flex-col min-w-0",fileName:"text-default truncate",fileSize:"text-muted truncate",fileTrailingButton:""},variants:{color:{primary:"",secondary:"",success:"",info:"",warning:"",error:"",neutral:""},variant:{area:{wrapper:"px-4 py-3",base:"p-4"},button:{}},size:{xs:{base:"text-xs",icon:"size-4",file:"text-xs px-2 py-1 gap-1",fileWrapper:"flex-row gap-1"},sm:{base:"text-xs",icon:"size-4",file:"text-xs px-2.5 py-1.5 gap-1.5",fileWrapper:"flex-row gap-1"},md:{base:"text-sm",icon:"size-5",file:"text-xs px-2.5 py-1.5 gap-1.5"},lg:{base:"text-sm",icon:"size-5",file:"text-sm px-3 py-2 gap-2",fileSize:"text-xs"},xl:{base:"text-base",icon:"size-6",file:"text-sm px-3 py-2 gap-2"}},layout:{list:{root:"gap-2 items-start",files:"flex flex-col w-full gap-2",file:"min-w-0 flex items-center border border-default rounded-md w-full",fileTrailingButton:"ms-auto"},grid:{fileWrapper:"hidden",fileLeadingAvatar:"size-full rounded-lg",fileTrailingButton:"absolute -top-1.5 -end-1.5 p-0 rounded-full border-2 border-bg"}},position:{inside:"",outside:""},dropzone:{true:"border-dashed data-[dragging=true]:bg-elevated/25"},interactive:{true:""},highlight:{true:""},multiple:{true:""},disabled:{true:"cursor-not-allowed opacity-75"}},compoundVariants:[{color:"primary",class:"focus-visible:outline-primary"},{color:"secondary",class:"focus-visible:outline-secondary"},{color:"success",class:"focus-visible:outline-success"},{color:"info",class:"focus-visible:outline-info"},{color:"warning",class:"focus-visible:outline-warning"},{color:"error",class:"focus-visible:outline-error"},{color:"primary",highlight:!0,class:"border-primary"},{color:"secondary",highlight:!0,class:"border-secondary"},{color:"success",highlight:!0,class:"border-success"},{color:"info",highlight:!0,class:"border-info"},{color:"warning",highlight:!0,class:"border-warning"},{color:"error",highlight:!0,class:"border-error"},{color:"neutral",class:"focus-visible:outline-inverted"},{color:"neutral",highlight:!0,class:"border-inverted"},{size:"xs",layout:"list",class:{fileTrailingButton:"-me-1"}},{size:"sm",layout:"list",class:{fileTrailingButton:"-me-1.5"}},{size:"md",layout:"list",class:{fileTrailingButton:"-me-1.5"}},{size:"lg",layout:"list",class:{fileTrailingButton:"-me-2"}},{size:"xl",layout:"list",class:{fileTrailingButton:"-me-2"}},{variant:"button",size:"xs",class:{base:"p-1"}},{variant:"button",size:"sm",class:{base:"p-1.5"}},{variant:"button",size:"md",class:{base:"p-1.5"}},{variant:"button",size:"lg",class:{base:"p-2"}},{variant:"button",size:"xl",class:{base:"p-2"}},{layout:"grid",multiple:!0,class:{files:"grid grid-cols-2 md:grid-cols-3 gap-4 w-full",file:"p-0 aspect-square"}},{layout:"grid",multiple:!1,class:{file:"absolute inset-0 p-0"}},{interactive:!0,disabled:!1,class:"hover:bg-elevated/25"}],defaultVariants:{color:"primary",variant:"area",size:"md"}},Pe=["id","name","accept","multiple","required","disabled"],Ee=Object.assign({inheritAttrs:!1},{__name:"NuxtFileUpload",props:Z({as:{type:null,required:!1},id:{type:String,required:!1},name:{type:String,required:!1},icon:{type:String,required:!1},label:{type:String,required:!1},description:{type:String,required:!1},color:{type:null,required:!1},variant:{type:null,required:!1},size:{type:null,required:!1},layout:{type:null,required:!1,default:"grid"},position:{type:null,required:!1,default:"outside"},highlight:{type:Boolean,required:!1},accept:{type:String,required:!1,default:"*"},multiple:{type:Boolean,required:!1,default:!1},reset:{type:Boolean,required:!1,default:!1},dropzone:{type:Boolean,required:!1,default:!0},interactive:{type:Boolean,required:!1,default:!0},required:{type:Boolean,required:!1},disabled:{type:Boolean,required:!1},fileIcon:{type:String,required:!1},fileDelete:{type:[Boolean,Object],required:!1},fileDeleteIcon:{type:String,required:!1},class:{type:null,required:!1},ui:{type:null,required:!1}},{modelValue:{type:null},modelModifiers:{}}),emits:Z(["change"],["update:modelValue"]),setup(a,{expose:n,emit:o}){const e=a,u=o,h=fe(),l=ve(a,"modelValue"),p=ge(),{t:x}=ye(),[r,m]=Fe(),{isDragging:T,open:f,inputRef:c,dropzoneRef:F}=Ae({accept:e.accept,reset:e.reset,multiple:e.multiple,dropzone:e.dropzone,onUpdate:I}),{emitFormInput:S,emitFormChange:R,id:ie,name:se,disabled:E,ariaAttrs:oe}=be(e),q=D(()=>e.multiple?"area":e.variant),j=D(()=>e.variant==="button"&&!e.multiple?"grid":e.layout),N=D(()=>j.value==="grid"&&e.multiple?"inside":q.value==="button"?"outside":e.position),g=D(()=>X({extend:X(Ce),...p.ui?.fileUpload||{}})({dropzone:e.dropzone,interactive:e.interactive,color:e.color,size:e.size,variant:q.value,layout:j.value,position:N.value,multiple:e.multiple,highlight:e.highlight,disabled:e.disabled}));function re(i){return URL.createObjectURL(i)}function ne(i){if(i===0)return"0B";const y=1024,v=["B","KB","MB","GB"],U=Math.floor(Math.log(i)/Math.log(y)),V=i/Math.pow(y,U);return`${U===0?V.toString():V.toFixed(0)}${v[U]}`}function I(i,y=!1){if(e.multiple)if(y)l.value=i;else{const U=l.value||[];l.value=[...U,...i||[]]}else l.value=i?.[0];const v=new Event("change",{target:{value:l.value}});u("change",v),R(),S()}function A(i){if(!l.value)return;if(!e.multiple||i===void 0){I([],!0),F.value?.focus();return}const y=[...l.value];y.splice(i,1),I(y,!0),F.value?.focus()}return ee(l,i=>{(!Array.isArray(i)||!i.length)&&c.value&&(c.value.value="")}),n({inputRef:c,dropzoneRef:F}),(i,y)=>(s(),b(C,null,[$(t(r),null,{default:B(()=>[l.value&&(!Array.isArray(l.value)||l.value.length)?(s(),b(C,{key:0},[k(i.$slots,"files-top",{files:l.value,open:t(f),removeFile:A}),d("div",{class:z(g.value.files({class:e.ui?.files}))},[k(i.$slots,"files",{files:l.value},()=>[(s(!0),b(C,null,te(Array.isArray(l.value)?l.value:[l.value],(v,U)=>(s(),b("div",{key:v.name,class:z(g.value.file({class:e.ui?.file}))},[k(i.$slots,"file",{file:v,index:U},()=>[k(i.$slots,"file-leading",{file:v,index:U},()=>[$(Y,{src:re(v),icon:a.fileIcon||t(p).ui.icons.file,size:e.size,class:z(g.value.fileLeadingAvatar({class:e.ui?.fileLeadingAvatar}))},null,8,["src","icon","size","class"])]),d("div",{class:z(g.value.fileWrapper({class:e.ui?.fileWrapper}))},[d("span",{class:z(g.value.fileName({class:e.ui?.fileName}))},[k(i.$slots,"file-name",{file:v,index:U},()=>[O(P(v.name),1)])],2),d("span",{class:z(g.value.fileSize({class:e.ui?.fileSize}))},[k(i.$slots,"file-size",{file:v,index:U},()=>[O(P(ne(v.size)),1)])],2)],2),k(i.$slots,"file-trailing",{file:v,index:U},()=>[$(L,G({color:"neutral"},{ref_for:!0},{...j.value==="grid"?{variant:"solid",size:"xs"}:{variant:"link",size:a.size},...typeof a.fileDelete=="object"?a.fileDelete:void 0},{"aria-label":t(x)("fileUpload.removeFile",{filename:v.name}),"trailing-icon":a.fileDeleteIcon||t(p).ui.icons.close,class:g.value.fileTrailingButton({class:e.ui?.fileTrailingButton}),onClick:J(V=>A(U),["stop","prevent"])}),null,16,["aria-label","trailing-icon","class","onClick"])])])],2))),128))])],2),k(i.$slots,"files-bottom",{files:l.value,open:t(f),removeFile:A})],64)):w("",!0)]),_:3}),$(t(ze),{as:a.as,class:z(g.value.root({class:[e.ui?.root,e.class]}))},{default:B(()=>[k(i.$slots,"default",{open:t(f),removeFile:A},()=>[(s(),_(he(q.value==="button"?"button":"div"),{ref_key:"dropzoneRef",ref:F,role:q.value==="button"?void 0:"button","data-dragging":t(T),class:z(g.value.base({class:e.ui?.base})),tabindex:a.interactive&&!t(E)?0:-1,onClick:y[0]||(y[0]=v=>a.interactive&&!t(E)&&t(f)()),onKeydown:y[1]||(y[1]=J(()=>{},["prevent"])),onKeyup:y[2]||(y[2]=xe(v=>a.interactive&&!t(E)&&t(f)(),["enter","space"]))},{default:B(()=>[N.value==="inside"?(s(),_(t(m),{key:0})):w("",!0),N.value!=="inside"||(a.multiple?!l.value?.length:!l.value)?(s(),b("div",{key:1,class:z(g.value.wrapper({class:e.ui?.wrapper}))},[k(i.$slots,"leading",{},()=>[q.value==="button"?(s(),_(ae,{key:0,name:a.icon||t(p).ui.icons.upload,class:z(g.value.icon({class:e.ui?.icon}))},null,8,["name","class"])):(s(),_(Y,{key:1,icon:a.icon||t(p).ui.icons.upload,size:e.size,class:z(g.value.avatar({class:e.ui?.avatar}))},null,8,["icon","size","class"]))]),q.value!=="button"?(s(),b(C,{key:0},[a.label||h.label?(s(),b("div",{key:0,class:z(g.value.label({class:e.ui?.label}))},[k(i.$slots,"label",{},()=>[O(P(a.label),1)])],2)):w("",!0),a.description||h.description?(s(),b("div",{key:1,class:z(g.value.description({class:e.ui?.description}))},[k(i.$slots,"description",{},()=>[O(P(a.description),1)])],2)):w("",!0),h.actions?(s(),b("div",{key:2,class:z(g.value.actions({class:e.ui?.actions}))},[k(i.$slots,"actions",{files:l.value,open:t(f),removeFile:A})],2)):w("",!0)],64)):w("",!0)],2)):w("",!0)]),_:3},40,["role","data-dragging","class","tabindex"])),N.value==="outside"?(s(),_(t(m),{key:0})):w("",!0)]),d("input",G({id:t(ie),ref_key:"inputRef",ref:c,type:"file",name:t(se),accept:a.accept,multiple:a.multiple,required:a.required,disabled:t(E)},{...i.$attrs,...t(oe)},{class:"sr-only",tabindex:"-1"}),null,16,Pe)]),_:3},8,["as","class"])],64))}}),Ne=[{label:"Passport Photograph",value:"passportUrl"},{label:"Birth Certificate",value:"birthCertificateUrl"},{label:"State of Origin Certificate",value:"stateOfOriginUrl"},{label:"O Level Result",value:"oLevelResultUrl"},{label:"Post UTME Registration Slip",value:"postUTMESlipUrl"},{label:"Admission Form Payment Receipt",value:"admissionFormPaymentReceiptUrl"}];async function Me(a){const{data:n,error:o}=await Oe(a),e=a.name.split("."),u=e.length>1?e.pop():null,h=e.join(".");return{data:n?{name:h,size:a.size,type:a.type,ext:u,data:n}:null,error:o??null}}async function Oe(a){return new Promise(n=>{const o=new FileReader;o.readAsDataURL(a),o.onload=()=>n({data:o.result,error:null}),o.onerror=()=>n({data:null,error:new Error("Failed to process file")})})}const Le={class:"flex justify-end"},Q=2*1024*1024,je=W({__name:"document-upload-form",props:{applicationId:{}},emits:["upload"],setup(a,{emit:n}){const o=le(),e=n,u=["image/jpeg","image/jpg","image/png","image/webp","application/pdf"],h=Ue({maxFileSize:Q,acceptedFileTypes:u}),l=H({documentType:void 0,file:void 0});async function p(x){const{data:r}=x,m=await Me(r.file);if(m.error||!m.data){o.add({color:"error",title:"Error",description:m.error?.message??"Failed to process file. Try again later"});return}const T={type:r.documentType,file:m.data};try{const f=await $fetch(`/api/users/applicant/applications/${a.applicationId}/documents`,{method:"POST",body:T});e("upload"),l.documentType=void 0,l.file=void 0,o.add({color:"success",title:"Success",description:f.message})}catch(f){o.add({color:"error",title:"Error",description:K(f).message})}}return(x,r)=>{const m=ce,T=pe,f=Ee,c=L,F=de;return s(),_(F,{state:t(l),schema:t(h),class:"space-y-5",onSubmit:p},{default:B(()=>[$(T,{name:"documentType",label:"Document Type",required:""},{default:B(()=>[$(m,{modelValue:t(l).documentType,"onUpdate:modelValue":r[0]||(r[0]=S=>t(l).documentType=S),items:t(Ne),size:"lg",class:"w-full"},null,8,["modelValue","items"])]),_:1}),$(T,{name:"file",label:"Document",required:""},{default:B(()=>[$(f,{modelValue:t(l).file,"onUpdate:modelValue":r[1]||(r[1]=S=>t(l).file=S),description:`PDF or Image file (max: ${("formatBytes"in x?x.formatBytes:t(Te))(Q)})`,layout:"list",accept:u.join(),class:"min-h-40"},null,8,["modelValue","description","accept"])]),_:1}),d("div",Le,[$(c,{type:"submit",label:"Submit","loading-auto":""})])]),_:1},8,["state","schema"])}}}),Ie=Object.assign(je,{__name:"ApplicationDocumentUploadForm"}),Ve={class:"flex items-center gap-1 justify-between"},We={class:"flex items-center gap-1"},Ke={class:"text-sm font-semibold text-muted"},Ze={key:0,class:"flex items-center gap-2.5"},Xe=["href"],Ye=W({__name:"document-card",props:{document:{},applicationId:{},status:{default:()=>{}}},emits:["remove"],setup(a,{emit:n}){const o=le(),{confirmAsync:e}=_e(),u=n;async function h(){if(await e({title:"Delete Document",description:"Are you sure you want to proceed?"}))try{const p=await $fetch(`/api/users/applicant/applications/${a.applicationId}/documents`,{method:"PUT",body:{key:a.document.key}});u("remove"),o.add({color:"success",title:"Success",description:p.message})}catch(p){o.add({color:"error",title:"Error",description:K(p).message})}}return(l,p)=>{const x=ae,r=L,m=Be;return s(),_(m,null,{default:B(()=>[d("div",Ve,[d("div",We,[a.document.value?(s(),_(x,{key:0,name:"lucide:circle-check",class:"text-success",size:"1.5rem"})):(s(),_(x,{key:1,name:"lucide:circle-x",class:"text-error",size:"1.5rem"})),d("p",Ke,P(a.document.label),1)]),a.document.value?(s(),b("div",Ze,[!l.status||l.status==="pending"?(s(),_(r,{key:0,icon:"lucide:trash",size:"sm",color:"error",variant:"soft","loading-auto":"",onClick:h})):w("",!0),d("a",{href:a.document.value,download:""},[$(r,{icon:"lucide:download",size:"sm",color:"neutral",variant:"soft"})],8,Xe)])):w("",!0)])]),_:1})}}}),Ge=Object.assign(Ye,{__name:"ApplicationDocumentCard"}),Je={class:"w-full"},Qe={class:"lg:max-w-[70%] mx-auto"},He={class:"my-5"},et={key:0},tt={key:1},at={class:"mt-10"},lt={class:"grid gap-2.5"},it={key:0,class:"flex items-center gap-2.5 justify-between"},Ft=W({__name:"index",async setup(a){let n,o;const{applicationId:e=""}=qe(),{data:u,error:h,refresh:l}=([n,o]=ke(()=>De(`/api/users/applicant/applications/${e}`,"$clTMJxKlyN")),n=await n,o(),n),p=D(()=>[{label:"Passport Photograph",value:u.value?.passportUrl??"",key:"passportUrl"},{label:"Birth Certificate",value:u.value?.birthCertificateUrl??"",key:"birthCertificateUrl"},{label:"State of Origin Certificate",value:u.value?.stateOfOriginUrl??"",key:"stateOfOriginUrl"},{label:"O Level Result",value:u.value?.oLevelResultUrl??"",key:"oLevelResultUrl"},{label:"Post UTME Registration Slip",value:u.value?.postUTMESlipUrl??"",key:"postUTMESlipUrl"},{label:"Admission Form Payment Receipt",value:u.value?.admissionFormPaymentReceiptUrl??"",key:"admissionFormPaymentReceiptUrl"}]);return(x,r)=>{const m=ue,T=Ie,f=Se,c=Ge,F=L;return s(),b("div",Je,[d("div",Qe,[r[3]||(r[3]=d("header",null,[d("h1",{class:"text-xl font-bold"},"Documents"),d("p",{class:"text-sm muted"}," Please upload the required documents to complete your application. ")],-1)),d("section",He,[t(h)?(s(),b("div",et,[$(m,{message:("normalizeException"in x?x.normalizeException:t(K))(t(h)).message,"show-retry":"",onRetry:t(l)},null,8,["message","onRetry"])])):t(u)?(s(),b("div",tt,[t(u).status==="pending"?(s(),_(T,{key:0,"application-id":t(e),onUpload:r[0]||(r[0]=()=>t(l)())},null,8,["application-id"])):w("",!0),d("div",at,[r[2]||(r[2]=d("p",{class:"text-lg font-semibold"},"Uploaded",-1)),$(f,{class:"mt-1 mb-5"}),d("div",lt,[(s(!0),b(C,null,te(t(p),S=>(s(),_(c,{key:S.label,document:S,"application-id":t(e),status:t(u).status,onRemove:r[1]||(r[1]=()=>t(l)())},null,8,["document","application-id","status"]))),128))])])])):w("",!0)]),t(u)?(s(),b("footer",it,[$(F,{to:`/application/portal/${t(e)}/academic-info`,label:"Previous",color:"neutral",variant:"soft"},null,8,["to"]),t(u).status!=="pending"?(s(),_(F,{key:0,to:`/application/portal/${t(e)}/review`,label:"Next"},null,8,["to"])):(s(),_(F,{key:1,to:`/application/portal/${t(e)}/review`,label:"Continue"},null,8,["to"]))])):w("",!0)])])}}});export{Ft as default};
