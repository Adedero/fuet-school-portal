import{_ as pe}from"./ny5Wg1iX.js";import{_ as me}from"./NFQeHh7q.js";import{f as $,O as Y,i as y,o as c,w as d,Q as P,d as F,R as V,k as s,S as E,T as fe,N as ge,M as ve,P as h,a9 as _e,aa as be,t as ye,y as H,A as U,z as Z,c as z,a as w,b as u,J as T,s as ee,B as te,g as I,$ as Pe,ab as he,a0 as Ce,a1 as xe,a2 as Se,a5 as Q,a6 as M,j as B,F as W,r as qe,n as $e,ac as Ne,q as X,G as D}from"#entry";import{_ as ae}from"./CsCpuQOu.js";import{_ as se,a as ne}from"./tvyaI-9O.js";import{_ as oe}from"./zwFKdr3r.js";import{_ as Ie}from"./DoiJs5pB.js";import{z as j}from"./BnhhJy-q.js";import{n as K}from"./Zkazc4B7.js";import{_ as we}from"./BtPAQVJY.js";import{_ as ze,g as Ae}from"./B0CdBYUg.js";import{u as Re}from"./Dd6P5Vqf.js";import"./CuGSGFmI.js";import"./CAoX7tgf.js";import"./DGOa__Ri.js";import"./DFpZvX7f.js";import"./DY9up4i8.js";import"./ByYrLWxT.js";import"./BaSubFUB.js";import"./CVy6mgnn.js";import"./PZTdxXR1.js";import"./jFYhBC76.js";import"./CG7Kytdp.js";import"./CrQKmWKl.js";import"./DV6tVSyL.js";import"./CT8naASD.js";import"./DrzXPWwZ.js";var Ve=$({__name:"PaginationEllipsis",props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(t){const o=t;return Y(),(e,r)=>(c(),y(s(E),V(o,{"data-type":"ellipsis"}),{default:d(()=>[P(e.$slots,"default",{},()=>[r[0]||(r[0]=F("â€¦"))])]),_:3},16))}}),Ye=Ve;const[L,Ee]=fe("PaginationRoot");var ke=$({__name:"PaginationRoot",props:{page:{type:Number,required:!1},defaultPage:{type:Number,required:!1,default:1},itemsPerPage:{type:Number,required:!0},total:{type:Number,required:!1,default:0},siblingCount:{type:Number,required:!1,default:2},disabled:{type:Boolean,required:!1},showEdges:{type:Boolean,required:!1,default:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"nav"}},emits:["update:page"],setup(t,{emit:o}){const e=t,r=o,{siblingCount:n,disabled:a,showEdges:l}=ge(e);Y();const _=ve(e,"page",r,{defaultValue:e.defaultPage,passive:e.page===void 0}),f=h(()=>Math.max(1,Math.ceil(e.total/(e.itemsPerPage||1))));return Ee({page:_,onPageChange(i){_.value=i},pageCount:f,siblingCount:n,disabled:a,showEdges:l}),(i,p)=>(c(),y(s(E),{as:i.as,"as-child":i.asChild},{default:d(()=>[P(i.$slots,"default",{page:s(_),pageCount:f.value})]),_:3},8,["as","as-child"]))}}),Me=ke,Be=$({__name:"PaginationFirst",props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"button"}},setup(t){const o=t,e=L();Y();const r=h(()=>e.page.value===1||e.disabled.value);return(n,a)=>(c(),y(s(E),V(o,{"aria-label":"First Page",type:n.as==="button"?"button":void 0,disabled:r.value,onClick:a[0]||(a[0]=l=>!r.value&&s(e).onPageChange(1))}),{default:d(()=>[P(n.$slots,"default",{},()=>[a[1]||(a[1]=F("First page"))])]),_:3},16,["type","disabled"]))}}),Fe=Be,Le=$({__name:"PaginationLast",props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"button"}},setup(t){const o=t,e=L();Y();const r=h(()=>e.page.value===e.pageCount.value||e.disabled.value);return(n,a)=>(c(),y(s(E),V(o,{"aria-label":"Last Page",type:n.as==="button"?"button":void 0,disabled:r.value,onClick:a[0]||(a[0]=l=>!r.value&&s(e).onPageChange(s(e).pageCount.value))}),{default:d(()=>[P(n.$slots,"default",{},()=>[a[1]||(a[1]=F("Last page"))])]),_:3},16,["type","disabled"]))}}),De=Le;function R(t,o){const e=o-t+1;return Array.from({length:e},(r,n)=>n+t)}function Ue(t){return t.map(o=>typeof o=="number"?{type:"page",value:o}:{type:"ellipsis"})}const O="ellipsis";function je(t,o,e,r){const a=o,l=Math.max(t-e,1),_=Math.min(t+e,a);if(r){const i=Math.min(2*e+5,o)-2,p=l>3&&Math.abs(a-i-1+1)>2&&Math.abs(l-1)>2,C=_<a-2&&Math.abs(a-i)>2&&Math.abs(a-_)>2;if(!p&&C)return[...R(1,i),O,a];if(p&&!C){const b=R(a-i+1,a);return[1,O,...b]}if(p&&C){const b=R(l,_);return[1,O,...b,O,a]}return R(1,a)}else{const f=e*2+1;return o<f?R(1,a):t<=e+1?R(1,f):o-t<=e?R(o-f+1,a):R(l,_)}}var Oe=$({__name:"PaginationList",props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(t){const o=t;Y();const e=L(),r=h(()=>Ue(je(e.page.value,e.pageCount.value,e.siblingCount.value,e.showEdges.value)));return(n,a)=>(c(),y(s(E),_e(be(o)),{default:d(()=>[P(n.$slots,"default",{items:r.value})]),_:3},16))}}),Te=Oe,Ke=$({__name:"PaginationListItem",props:{value:{type:Number,required:!0},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"button"}},setup(t){const o=t;Y();const e=L(),r=h(()=>e.page.value===o.value),n=h(()=>e.disabled.value);return(a,l)=>(c(),y(s(E),V(o,{"data-type":"page","aria-label":`Page ${a.value}`,"aria-current":r.value?"page":void 0,"data-selected":r.value?"true":void 0,disabled:n.value,type:a.as==="button"?"button":void 0,onClick:l[0]||(l[0]=_=>!n.value&&s(e).onPageChange(a.value))}),{default:d(()=>[P(a.$slots,"default",{},()=>[F(ye(a.value),1)])]),_:3},16,["aria-label","aria-current","data-selected","disabled","type"]))}}),Ge=Ke,He=$({__name:"PaginationNext",props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"button"}},setup(t){const o=t;Y();const e=L(),r=h(()=>e.page.value===e.pageCount.value||e.disabled.value);return(n,a)=>(c(),y(s(E),V(o,{"aria-label":"Next Page",type:n.as==="button"?"button":void 0,disabled:r.value,onClick:a[0]||(a[0]=l=>!r.value&&s(e).onPageChange(s(e).page.value+1))}),{default:d(()=>[P(n.$slots,"default",{},()=>[a[1]||(a[1]=F("Next page"))])]),_:3},16,["type","disabled"]))}}),Je=He,Qe=$({__name:"PaginationPrev",props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"button"}},setup(t){const o=t;Y();const e=L(),r=h(()=>e.page.value===1||e.disabled.value);return(n,a)=>(c(),y(s(E),V(o,{"aria-label":"Previous Page",type:n.as==="button"?"button":void 0,disabled:r.value,onClick:a[0]||(a[0]=l=>!r.value&&s(e).onPageChange(s(e).page.value-1))}),{default:d(()=>[P(n.$slots,"default",{},()=>[a[1]||(a[1]=F("Prev page"))])]),_:3},16,["type","disabled"]))}}),We=Qe;const le=j.object({name:j.string("Invalid session name").nonempty("Session name is required"),startYear:j.number("Start year of session is required.")}),Xe=j.object({...le.shape,isCurrent:j.boolean("Current status of session must be true or false")}),Ze=$({__name:"creator",emits:["add"],setup(t,{emit:o}){const e=H(),r=o,n=U(!1),a=Z({name:"",startYear:new Date().getFullYear(),isCurrent:!1}),l=()=>{a.name="",a.startYear=new Date().getFullYear(),a.isCurrent=!1};async function _(f){const{data:i}=f;try{const{message:p,session:C}=await $fetch("/api/users/admin/sessions",{method:"POST",body:i});r("add",C),n.value=!1,l(),e.add({color:"success",title:"Success",description:p})}catch(p){e.add({color:"error",title:"Error",description:K(p).message})}}return(f,i)=>{const p=I,C=ae,g=ne,b=oe,A=Ie,x=se,q=ee;return c(),z("div",null,[w("div",{onClick:i[0]||(i[0]=S=>n.value=!0)},[P(f.$slots,"default",{},()=>[u(p,{label:"New",icon:"lucide:plus"})])]),u(q,{open:s(n),"onUpdate:open":i[4]||(i[4]=S=>T(n)?n.value=S:null),title:"Create Session"},{body:d(()=>[u(x,{state:s(a),schema:s(Xe),class:"space-y-5",onSubmit:te(_,["prevent"])},{default:d(()=>[u(g,{name:"name",label:"Session name",required:""},{default:d(()=>[u(C,{modelValue:s(a).name,"onUpdate:modelValue":i[1]||(i[1]=S=>s(a).name=S),size:"lg",class:"w-full"},null,8,["modelValue"])]),_:1}),u(g,{name:"startYear",label:"Official starting year",required:""},{default:d(()=>[u(b,{modelValue:s(a).startYear,"onUpdate:modelValue":i[2]||(i[2]=S=>s(a).startYear=S),size:"lg",class:"w-full",orientation:"vertical","format-options":{useGrouping:"false"}},null,8,["modelValue"])]),_:1}),u(g,{name:"isCurrent",required:""},{default:d(()=>[u(A,{modelValue:s(a).isCurrent,"onUpdate:modelValue":i[3]||(i[3]=S=>s(a).isCurrent=S),size:"lg",label:"Set as current session"},null,8,["modelValue"])]),_:1}),u(p,{type:"submit","loading-auto":"",label:"Submit"})]),_:1},8,["state","schema"])]),_:1},8,["open"])])}}}),et=Object.assign(Ze,{__name:"AdminAcademicSessionCreator"}),tt={slots:{root:"",list:"flex items-center gap-1",ellipsis:"pointer-events-none",label:"min-w-5 text-center",first:"",prev:"",item:"",next:"",last:""}},at={__name:"NuxtPagination",props:{as:{type:null,required:!1},firstIcon:{type:String,required:!1},prevIcon:{type:String,required:!1},nextIcon:{type:String,required:!1},lastIcon:{type:String,required:!1},ellipsisIcon:{type:String,required:!1},color:{type:null,required:!1,default:"neutral"},variant:{type:null,required:!1,default:"outline"},activeColor:{type:null,required:!1,default:"primary"},activeVariant:{type:null,required:!1,default:"solid"},showControls:{type:Boolean,required:!1,default:!0},size:{type:null,required:!1},to:{type:Function,required:!1},class:{type:null,required:!1},ui:{type:null,required:!1},defaultPage:{type:Number,required:!1},disabled:{type:Boolean,required:!1},itemsPerPage:{type:Number,required:!1,default:10},page:{type:Number,required:!1},showEdges:{type:Boolean,required:!1,default:!1},siblingCount:{type:Number,required:!1,default:2},total:{type:Number,required:!1,default:0}},emits:["update:page"],setup(t,{emit:o}){const e=t,r=o,n=Pe(),{dir:a}=he(),l=Ce(),_=xe(Se(e,"as","defaultPage","disabled","itemsPerPage","page","showEdges","siblingCount","total"),r),f=h(()=>e.firstIcon||(a.value==="rtl"?l.ui.icons.chevronDoubleRight:l.ui.icons.chevronDoubleLeft)),i=h(()=>e.prevIcon||(a.value==="rtl"?l.ui.icons.chevronRight:l.ui.icons.chevronLeft)),p=h(()=>e.nextIcon||(a.value==="rtl"?l.ui.icons.chevronLeft:l.ui.icons.chevronRight)),C=h(()=>e.lastIcon||(a.value==="rtl"?l.ui.icons.chevronDoubleLeft:l.ui.icons.chevronDoubleRight)),g=h(()=>Q({extend:Q(tt),...l.ui?.pagination||{}})());return(b,A)=>(c(),y(s(Me),V(s(_),{class:g.value.root({class:[e.ui?.root,e.class]})}),{default:d(({page:x,pageCount:q})=>[u(s(Te),{class:M(g.value.list({class:e.ui?.list}))},{default:d(({items:S})=>[t.showControls||n.first?(c(),y(s(Fe),{key:0,"as-child":"",class:M(g.value.first({class:e.ui?.first}))},{default:d(()=>[P(b.$slots,"first",{},()=>[u(I,{color:t.color,variant:t.variant,size:t.size,icon:f.value,to:t.to?.(1)},null,8,["color","variant","size","icon","to"])])]),_:3},8,["class"])):B("",!0),t.showControls||n.prev?(c(),y(s(We),{key:1,"as-child":"",class:M(g.value.prev({class:e.ui?.prev}))},{default:d(()=>[P(b.$slots,"prev",{},()=>[u(I,{color:t.color,variant:t.variant,size:t.size,icon:i.value,to:x>1?t.to?.(x-1):void 0},null,8,["color","variant","size","icon","to"])])]),_:2},1032,["class"])):B("",!0),(c(!0),z(W,null,qe(S,(N,v)=>(c(),z(W,null,[N.type==="page"?(c(),y(s(Ge),{key:v,"as-child":"",value:N.value,class:M(g.value.item({class:e.ui?.item}))},{default:d(()=>[P(b.$slots,"item",V({ref_for:!0},{item:N,index:v,page:x,pageCount:q}),()=>[u(I,{color:x===N.value?t.activeColor:t.color,variant:x===N.value?t.activeVariant:t.variant,size:t.size,label:String(N.value),ui:{label:g.value.label()},to:t.to?.(N.value),square:""},null,8,["color","variant","size","label","ui","to"])])]),_:2},1032,["value","class"])):(c(),y(s(Ye),{key:N.type,index:v,"as-child":"",class:M(g.value.ellipsis({class:e.ui?.ellipsis}))},{default:d(()=>[P(b.$slots,"ellipsis",{},()=>[u(I,{color:t.color,variant:t.variant,size:t.size,icon:t.ellipsisIcon||s(l).ui.icons.ellipsis},null,8,["color","variant","size","icon"])])]),_:3},8,["index","class"]))],64))),256)),t.showControls||n.next?(c(),y(s(Je),{key:2,"as-child":"",class:M(g.value.next({class:e.ui?.next}))},{default:d(()=>[P(b.$slots,"next",{},()=>[u(I,{color:t.color,variant:t.variant,size:t.size,icon:p.value,to:x<q?t.to?.(x+1):void 0},null,8,["color","variant","size","icon","to"])])]),_:2},1032,["class"])):B("",!0),t.showControls||n.last?(c(),y(s(De),{key:3,"as-child":"",class:M(g.value.last({class:e.ui?.last}))},{default:d(()=>[P(b.$slots,"last",{},()=>[u(I,{color:t.color,variant:t.variant,size:t.size,icon:C.value,to:t.to?.(q)},null,8,["color","variant","size","icon","to"])])]),_:2},1032,["class"])):B("",!0)]),_:2},1032,["class"])]),_:3},16,["class"]))}},st=$({__name:"editor",props:{session:{}},emits:["update"],setup(t,{emit:o}){const e=H(),r=o,n=Z({name:t.session.name,startYear:t.session.startYear}),a=()=>{n.name="",n.startYear=new Date().getFullYear()};async function l(_){const{data:f}=_;try{const{message:i,session:p}=await $fetch(`/api/users/admin/sessions/${t.session.id}`,{method:"PUT",body:f});r("update",p),a(),e.add({color:"success",title:"Success",description:i})}catch(i){e.add({color:"error",title:"Error",description:K(i).message})}}return(_,f)=>{const i=ae,p=ne,C=oe,g=I,b=se;return c(),z("div",null,[u(b,{state:s(n),schema:s(le),class:"space-y-5",onSubmit:te(l,["prevent"])},{default:d(()=>[u(p,{name:"name",label:"Session name",required:""},{default:d(()=>[u(i,{modelValue:s(n).name,"onUpdate:modelValue":f[0]||(f[0]=A=>s(n).name=A),size:"lg",class:"w-full"},null,8,["modelValue"])]),_:1}),u(p,{name:"startYear",label:"Official starting year",required:""},{default:d(()=>[u(C,{modelValue:s(n).startYear,"onUpdate:modelValue":f[1]||(f[1]=A=>s(n).startYear=A),size:"lg",class:"w-full",orientation:"vertical","format-options":{useGrouping:"false"}},null,8,["modelValue"])]),_:1}),u(g,{type:"submit","loading-auto":"",label:"Submit"})]),_:1},8,["state","schema"])])}}}),nt=Object.assign(st,{__name:"AdminAcademicSessionEditor"}),ot={class:"mt-2.5 flex justify-end"},lt=$({__name:"set-current",props:{sessionId:{}},emits:["update"],setup(t,{emit:o}){const e=H(),r=o;async function n(){try{const{message:a}=await $fetch(`/api/users/admin/sessions/${t.sessionId}/set-current`,{method:"PUT"});r("update",t.sessionId),e.add({color:"success",title:"Success",description:a})}catch(a){e.add({color:"error",title:"Error",description:K(a).message})}}return(a,l)=>{const _=I;return c(),z("div",null,[l[0]||(l[0]=w("p",null,"Do you want to set this session as the current session?",-1)),w("div",ot,[u(_,{label:"Proceed","loading-auto":"",onClick:n})])])}}}),it=Object.assign(lt,{__name:"AdminAcademicSessionSetCurrent"}),rt={class:"p-5"},ut={class:"flex items-center gap-5 justify-between"},dt={class:"mt-5"},ct={key:0},pt={key:1},mt={class:"flex justify-center border-t border-default pt-4"},ft={key:0},Ut=$({__name:"index",async setup(t){let o,e;const r=pe,n=me,a=I,{data:l,error:_,pending:f,refresh:i}=([o,e]=$e(()=>Re("/api/general/academic-sessions","$fxG4LeaPHo")),o=await o,e(),o),p=Ne("table"),C=h(()=>[{accessorKey:"id",header:"#",cell:({row:v})=>{const m=v.getValue("id");return D("span",{title:m},`${m.slice(0,6)}...`)}},{accessorKey:"name",header:"Name"},{accessorKey:"startYear",header:"Offical Year Started"},{accessorKey:"currentYear",header:"Actual Year Sarted"},{accessorKey:"isCurrent",header:"Current Session",cell:({row:v})=>{const m=v.getValue("isCurrent");return D(r,{class:"capitalize",variant:"subtle",color:m?"success":"error"},()=>`${m}`)}},{accessorKey:"createdAt",header:"Created",cell:({row:v})=>X(v.getValue("createdAt"),"DD MMM, YYYY hh:mm aa").value},{accessorKey:"updatedAt",header:"Updated",cell:({row:v})=>X(v.getValue("updatedAt"),"DD MMM, YYYY hh:mm aa").value},{id:"actions",cell:({row:v})=>D("div",{class:"text-right"},D(n,{content:{align:"end"},items:A(v),"aria-label":"Actions dropdown"},()=>D(a,{icon:"i-lucide-ellipsis-vertical",color:"neutral",variant:"ghost",class:"ml-auto","aria-label":"Actions dropdown"})))}]),g=U(!1),b=U(!1);function A(v){return[{type:"label",label:"Actions"},{label:"Edit Session",onSelect(){S(v.original.id,g)}},{label:"Set as current",onSelect(){S(v.original.id,b)}},{type:"separator"},{label:"Delete session"}]}const x=U({pageIndex:0,pageSize:10}),q=U(null);function S(v,m){q.value=l.value?.find(G=>G.id===v)??null,q.value&&(m.value=!0)}async function N(v){await i(),q.value=null}return(v,m)=>{const G=et,ie=we,re=ze,ue=at,de=nt,J=ee,ce=it;return c(),z("div",rt,[w("header",null,[w("div",ut,[m[7]||(m[7]=w("h1",{class:"text-lg font-bold"},"Academic Sessions",-1)),w("div",null,[s(l)?(c(),y(G,{key:0,onAdd:m[0]||(m[0]=()=>s(i)())})):B("",!0)])])]),w("section",dt,[s(_)?(c(),z("div",ct,[u(ie,{message:("normalizeException"in v?v.normalizeException:s(K))(s(_)).message,"show-retry":"",onRetry:s(i)},null,8,["message","onRetry"])])):s(l)?(c(),z("div",pt,[u(re,{ref_key:"table",ref:p,pagination:s(x),"onUpdate:pagination":m[1]||(m[1]=k=>T(x)?x.value=k:null),data:s(l),columns:s(C),loading:s(f),"pagination-options":{getPaginationRowModel:s(Ae)()}},null,8,["pagination","data","columns","loading","pagination-options"]),w("div",mt,[u(ue,{"default-page":(s(p)?.tableApi?.getState().pagination.pageIndex||0)+1,"items-per-page":s(p)?.tableApi?.getState().pagination.pageSize,total:s(p)?.tableApi?.getFilteredRowModel().rows.length,"onUpdate:page":m[2]||(m[2]=k=>s(p)?.tableApi?.setPageIndex(k-1))},null,8,["default-page","items-per-page","total"])]),s(q)?(c(),z("div",ft,[u(J,{open:s(g),"onUpdate:open":m[4]||(m[4]=k=>T(g)?g.value=k:null),title:"Edit Session"},{body:d(()=>[u(de,{session:s(q),onUpdate:m[3]||(m[3]=()=>N(s(g)))},null,8,["session"])]),_:1},8,["open"]),u(J,{open:s(b),"onUpdate:open":m[6]||(m[6]=k=>T(b)?b.value=k:null),title:"Set Current Session"},{body:d(()=>[u(ce,{"session-id":s(q).id,onUpdate:m[5]||(m[5]=()=>N(s(b)))},null,8,["session-id"])]),_:1},8,["open"])])):B("",!0)])):B("",!0)])])}}});export{Ut as default};
