import{_ as L}from"./Bwamz-LN.js";import{f as S,A as j,B as N,c as y,o as c,a as r,b as o,O as B,w as v,g as I,k as e,D as E,x as R,M as z,a2 as F,i as g,j as k,Y,a1 as H,W as K,E as Q,s as X,a3 as Z,d as ee,t as te,I as oe,av as ne}from"#entry";import{n as w}from"./Zkazc4B7.js";import{_ as ae}from"./RyBLt_tc.js";import{_ as se}from"./CNL1yBOL.js";import{_ as M}from"./Br_2l1z2.js";import{_ as ie}from"./BrTgbP-L.js";import{_ as le}from"./CdUQPPYw.js";import{a as ce,_ as re}from"./CfG1-w7I.js";import{_ as pe}from"./DUGQhyV-.js";import{u as P}from"./C1RyDYw7.js";import{_ as ue}from"./Ywwxveuu.js";import{z as C}from"./ChM03Ocf.js";import{_ as de}from"./CjOVySSS.js";import{u as me}from"./BoFo4Dkd.js";import"./BFQ-zme-.js";import"./C7XPntmp.js";import"./DxgE_vvP.js";import"./BXv2KLq8.js";import"./CMJ2FhCh.js";import"./DD2e9X2d.js";import"./D1lORq9n.js";import"./BZPIhiCP.js";import"./CrxYuplo.js";import"./bGYnQNJU.js";import"./CuPKMK4g.js";import"./CSucrOrG.js";const _e={class:"flex items-center justify-end gap-2.5"},fe=S({__name:"accepter",props:{applicationId:{}},emits:["done"],setup(d,{emit:p}){const u=p,s=j(),a=N(!1);async function m(){try{const{message:i}=await $fetch(`/api/users/admin/applications/${d.applicationId}/update-status`,{method:"post",body:{status:"accepted"}});u("done"),a.value=!1,s.add({color:"success",title:"Success",description:i})}catch(i){s.add({color:"error",title:"Error",description:w(i).message})}}return(i,t)=>{const n=I,f=R;return c(),y("div",null,[r("div",{onClick:t[0]||(t[0]=l=>a.value=!0)},[B(i.$slots,"default")]),o(f,{open:e(a),"onUpdate:open":t[1]||(t[1]=l=>E(a)?a.value=l:null),title:"Accept Application",description:"Are you sure you want to accept this application?",dismissible:!1,close:!1},{body:v(({close:l})=>[r("div",null,[r("div",_e,[o(n,{label:"Cancel",color:"neutral",variant:"soft",onClick:l},null,8,["onClick"]),o(n,{label:"Proceed","loading-auto":"",onClick:m})])])]),_:1},8,["open"])])}}}),ve=Object.assign(fe,{__name:"ApplicationAccepter"}),ge={class:"flex items-center justify-end gap-2.5"},be=S({__name:"rejecter",props:{applicationId:{}},emits:["done"],setup(d,{emit:p}){const u=p,s=j(),a=N(!1);async function m(){try{const{message:i}=await $fetch(`/api/users/admin/applications/${d.applicationId}/update-status`,{method:"post",body:{status:"rejected"}});u("done"),a.value=!1,s.add({color:"success",title:"Success",description:i})}catch(i){s.add({color:"error",title:"Error",description:w(i).message})}}return(i,t)=>{const n=I,f=R;return c(),y("div",null,[r("div",{onClick:t[0]||(t[0]=l=>a.value=!0)},[B(i.$slots,"default")]),o(f,{open:e(a),"onUpdate:open":t[1]||(t[1]=l=>E(a)?a.value=l:null),title:"Accept Application",description:"Are you sure you want to reject this application?",dismissible:!1,close:!1},{body:v(({close:l})=>[r("div",null,[r("div",ge,[o(n,{label:"Cancel",color:"neutral",variant:"soft",onClick:l},null,8,["onClick"]),o(n,{label:"Proceed","loading-auto":"",onClick:m})])])]),_:1},8,["open"])])}}}),ye=Object.assign(be,{__name:"ApplicationRejecter"}),he=S({__name:"student-class-select",props:{modelValue:{default:void 0},modelModifiers:{}},emits:["update:modelValue"],setup(d){const{data:p,error:u,status:s,execute:a}=P("/api/general/student-classes",{lazy:!0},"$Up6cE9ckJh"),m=z(()=>s.value==="pending"),i=z(()=>(p.value??[]).map(n=>n.className)),t=F(d,"modelValue");return(n,f)=>{const l=pe,h=M;return c(),y("div",null,[e(m)||e(p)?(c(),g(l,Y({key:0,modelValue:t.value,"onUpdate:modelValue":f[0]||(f[0]=x=>t.value=x),items:e(i),loading:e(m)},n.$attrs),null,16,["modelValue","items","loading"])):e(u)?(c(),g(h,{key:1,message:"Failed to get student classes","show-retry":"",onRetry:e(a)},null,8,["onRetry"])):k("",!0)])}}}),Ae=Object.assign(he,{__name:"AppStudentClassSelect"}),ke=C.object({applicationId:C.string("Invalid application ID").nonempty("Application ID is required"),regNumber:C.string("Invalid registration number").nonempty("Registration number is required"),studentClass:C.string("Invalid student class").nonempty("Student class is required"),department:C.string("Invalid department").nonempty("Department is required")});function xe(d,p){const u=d.split("/");if(u.length!==3)return"";const s=u[1],a=u[2];return`FUET/${p}/${s}/${a}`}const $e={class:"flex items-center gap-2 justify-end"},Ce=S({__name:"creator",props:H({application:{}},{open:{type:Boolean},openModifiers:{}}),emits:["update:open"],setup(d){const p=j(),u=F(d,"open"),s=N({applicationId:d.application.id}),a=N(d.application.course?{label:d.application.course,value:"",faculty:""}:void 0);K(a,t=>s.value.department=t?.label);const m=()=>{if(!a.value?.value){p.add({color:"error",title:"Error",description:"Please select a department first"});return}const t=xe(d.application.applicationNumber,a.value.value);s.value.regNumber=t},i=async t=>{try{const{message:n}=await $fetch(`/api/users/admin/applications/${d.application.id}/create-student`,{method:"POST",body:t.data});u.value=!1,s.value={},p.add({color:"success",title:"Success",description:n})}catch(n){p.add({color:"error",title:"Error",description:w(n).message})}};return(t,n)=>{const f=le,l=ce,h=I,x=Ae,$=ue,_=re,V=R;return c(),g(V,{open:u.value,"onUpdate:open":n[3]||(n[3]=b=>u.value=b),title:"Add Student",dismissible:!1},{body:v(({close:b})=>[r("div",null,[o(_,{state:e(s),schema:e(ke),class:"grid gap-5",onSubmit:Q(i,["prevent"])},{default:v(()=>[o(l,{label:"Application ID",required:""},{default:v(()=>[o(f,{value:e(s).applicationId,disabled:"",size:"lg",class:"w-full"},null,8,["value"])]),_:1}),o(l,{name:"regNumber",label:"Registration/Matric Number",class:"relative",required:""},{default:v(()=>[o(f,{modelValue:e(s).regNumber,"onUpdate:modelValue":n[0]||(n[0]=A=>e(s).regNumber=A),size:"lg",class:"w-full"},null,8,["modelValue"]),o(h,{label:"generate","trailing-icon":"lucide:wand-sparkles",variant:"ghost",size:"sm",class:"absolute -top-7 right-0",onClick:m})]),_:1}),o(l,{name:"studentClass",label:"Student's Class",required:""},{default:v(()=>[o(x,{modelValue:e(s).studentClass,"onUpdate:modelValue":n[1]||(n[1]=A=>e(s).studentClass=A),size:"lg",class:"w-full"},null,8,["modelValue"])]),_:1}),o(l,{name:"department",label:"Department",required:""},{default:v(()=>[o($,{department:e(a),"onUpdate:department":n[2]||(n[2]=A=>E(a)?a.value=A:null),item:"department",size:"lg",class:"w-full"},null,8,["department"])]),_:1}),r("div",$e,[o(h,{type:"button",label:"Cancel",color:"neutral",variant:"soft",onClick:b},null,8,["onClick"]),o(h,{type:"submit",label:"Submit","loading-auto":""})])]),_:2},1032,["state","schema"])])]),_:1},8,["open"])}}}),Ne=Object.assign(Ce,{__name:"AdminStudentsCreator"}),we={class:"p-5"},Se={class:"flex items-center gap-5 justify-between"},je={class:"flex items-center gap-2"},Ie={class:"text-lg font-bold"},Ee={class:"mb-5 flex items-center justify-end gap-2.5"},Ve={class:"p-5"},De={class:"w-40 grid gap-1"},Re={class:"mt-5"},ze={key:0},Be={key:1},Fe={key:0,class:"mb-5"},Me={key:0},dt=S({__name:"index",async setup(d){let p,u;const s=j(),{confirmAsync:a}=ne(),m=N(!1),{applicationId:i=""}=me(),{data:t,error:n,refresh:f}=([p,u]=X(()=>P(`/api/users/admin/applications/${i}`,"$d99B_tMvGW")),p=await p,u(),p),l=Z("viewer"),h={pending:"secondary",submitted:"warning",accepted:"success",rejected:"error"},x=async()=>{if(await(async()=>await a({title:"Delete Application",description:"Are you sure you want to delete this application? This action cannot be undone",acceptProps:{color:"error",label:"Delete"}}))())try{const{message:_}=await $fetch(`/api/users/admin/applications/${i}`,{method:"DELETE"});oe("/portal/admin/applications"),s.add({color:"success",title:"Success",description:_})}catch(_){s.add({color:"error",title:"Error",description:w(_).message})}};return($,_)=>{const V=L,b=I,A=ve,U=ye,q=ae,T=se,O=M,D=ie,W=Ne,G=de;return c(),y("div",we,[r("header",null,[r("div",Se,[r("div",je,[r("h1",Ie,[_[3]||(_[3]=ee(" Application ",-1)),r("b",null,te(e(t)?.applicationNumber),1)]),e(t)?(c(),g(V,{key:0,label:e(t).status,color:h[e(t).status],variant:"subtle"},null,8,["label","color"])):k("",!0)]),r("div",Ee,[o(b,{label:"Print",icon:"lucide:printer",color:"neutral",variant:"outline",onClick:e(l)?.print},null,8,["onClick"]),e(t)?(c(),g(T,{key:0},{content:v(()=>[r("div",Ve,[r("div",De,[e(t).status==="submitted"||e(t).status==="rejected"?(c(),g(A,{key:0,"application-id":e(i),onDone:_[0]||(_[0]=()=>e(f)())},{default:v(()=>[o(b,{label:"Accept",color:"neutral",variant:"ghost","trailing-icon":"lucide:circle-check",block:""})]),_:1},8,["application-id"])):k("",!0),e(t).status==="submitted"||e(t).status==="accepted"?(c(),g(U,{key:1,"application-id":e(i),onDone:_[1]||(_[1]=()=>e(f)())},{default:v(()=>[o(b,{label:"Reject",color:"neutral",variant:"ghost","trailing-icon":"lucide:circle-x",block:""})]),_:1},8,["application-id"])):k("",!0),o(q),o(b,{label:"Delete",color:"error",variant:"ghost","trailing-icon":"lucide:trash-2",block:"","loading-auto":"",onClick:x})])])]),default:v(()=>[o(b,{icon:"lucide:ellipsis-vertical",color:"neutral",variant:"outline"})]),_:1})):k("",!0)])])]),r("section",Re,[e(n)?(c(),y("div",ze,[o(O,{message:("normalizeException"in $?$.normalizeException:e(w))(e(n)).message,"show-retry":"",onRetry:e(f)},null,8,["message","onRetry"])])):e(t)?(c(),y("div",Be,[e(t).status==="accepted"?(c(),y("div",Fe,[e(t).hasPaidAdmissionFee&&e(t).admissionFeePaymentId?(c(),y("div",Me,[e(t).student?(c(),g(D,{key:1,title:"Admission fee",description:"Applicant has paid the admission fee and has been approved as a student",icon:"lucide:info",color:"success",variant:"subtle"})):(c(),g(D,{key:0,title:"Admission fee",description:"Applicant has paid the admission fee",icon:"lucide:info",color:"success",variant:"subtle",orientation:"horizontal",actions:[{label:"Approve",icon:"lucide:circle-check",size:"sm",onClick:()=>{m.value=!0}}]},null,8,["actions"]))])):(c(),g(D,{key:1,title:"Admission Fee",description:"Applicant has not paid the admission fee",icon:"lucide:info",color:"warning",variant:"subtle"})),o(W,{open:e(m),"onUpdate:open":_[2]||(_[2]=J=>E(m)?m.value=J:null),application:e(t)},null,8,["open","application"])])):k("",!0),r("div",null,[o(G,{ref_key:"viewer",ref:l,"application-id":e(t).id},null,8,["application-id"])])])):k("",!0)])])}}});export{dt as default};
