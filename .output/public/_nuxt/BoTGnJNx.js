import{_ as k}from"./BtPAQVJY.js";import{_ as y}from"./CsCpuQOu.js";import{_ as S,a as C}from"./tvyaI-9O.js";import{f as V,x as z,z as B,A as _,c as f,j as $,b as t,k as n,w as o,B as F,J as U,s as j,o as p,g as A,d as I,a as d,C as M}from"#entry";import{n as R}from"./Zkazc4B7.js";import{z as w}from"./BnhhJy-q.js";const J={key:0,class:"mb-3"},O=V({__name:"change-email-form",setup(L){const r=z(),b=w.object({newEmail:w.email("Invalid email address")}),s=B({newEmail:""});function g(){s.newEmail=""}const a=_(null),l=_(!1);async function x(c){a.value=null;const{newEmail:e}=c.data;await M.changeEmail({newEmail:e,callbackURL:"/login"},{onError(i){a.value=R(i.error)},onSuccess(){g(),l.value=!0,r.setUser(null),r.setSession(null)}})}return(c,e)=>{const i=k,E=y,h=C,u=A,v=S,N=j;return p(),f("div",null,[n(a)?(p(),f("div",J,[t(i,{message:n(a).message},null,8,["message"])])):$("",!0),t(v,{schema:n(b),state:n(s),class:"space-y-4",onSubmit:F(x,["prevent"])},{default:o(()=>[t(h,{label:"New Email",name:"newEmail"},{default:o(()=>[t(E,{modelValue:n(s).newEmail,"onUpdate:modelValue":e[0]||(e[0]=m=>n(s).newEmail=m),size:"lg",class:"w-full"},null,8,["modelValue"])]),_:1}),t(u,{type:"submit",class:"mt-2 w-full flex-center",size:"lg",icon:"i-lucide:check-circle","loading-auto":""},{default:o(()=>[...e[2]||(e[2]=[I(" Submit ",-1)])]),_:1})]),_:1},8,["schema","state"]),t(N,{open:n(l),"onUpdate:open":e[1]||(e[1]=m=>U(l)?l.value=m:null),title:"Success",close:!1,dismissible:!1,ui:{footer:"justify-end"}},{body:o(()=>[...e[3]||(e[3]=[d("div",{class:"space-y-3"},[d("p",null," Click the link that has been sent to your current email to continue ")],-1)])]),footer:o(()=>[t(u,{to:"/login",label:"Continue","trailing-icon":"lucide:circle-arrow-right"})]),_:1},8,["open"])])}}});export{O as _};
