import{_ as Z}from"./D8n4x_QM.js";import{_ as ee}from"./OPR3eTXJ.js";import{f as E,A as D,B as N,C as P,c as C,a as b,b as s,O as te,w as _,D as U,k as e,x as O,o as x,E as R,g as M,s as se,a3 as ne,M as oe,i as ae,j as z,v as j,J as $}from"#entry";import{_ as q}from"./iSq_GXOF.js";import{_ as K,a as T}from"./2EICDMI2.js";import{_ as G}from"./BxE-QSiJ.js";import{_ as ie}from"./BvPn1KVB.js";import{z as V}from"./CQ9DD0Tp.js";import{n as F}from"./Zkazc4B7.js";import{_ as re}from"./Br_2l1z2.js";import{_ as le,g as ue}from"./rN6nCneX.js";import{_ as ce}from"./BqCZUlXI.js";import{u as de}from"./DmuB_ewQ.js";import"./C349kGaG.js";import"./CZ9GQ99X.js";import"./Dx-2vZsd.js";import"./Cp9dvClo.js";import"./fgKd3tbi.js";import"./DX__6iYn.js";import"./DOVLR_vN.js";import"./CPO5dxYl.js";import"./BZPIhiCP.js";import"./jFYhBC76.js";import"./BePoOrxp.js";import"./3OEFcGef.js";import"./ST9fJbop.js";import"./CDIhCsnd.js";import"./BrTgbP-L.js";const H=V.object({name:V.string("Invalid session name").nonempty("Session name is required"),startYear:V.number("Start year of session is required.")}),me=V.object({...H.shape,isCurrent:V.boolean("Current status of session must be true or false")}),pe=E({__name:"creator",emits:["add"],setup(S,{emit:p}){const u=D(),v=p,i=N(!1),o=P({name:"",startYear:new Date().getFullYear(),isCurrent:!1}),c=()=>{o.name="",o.startYear=new Date().getFullYear(),o.isCurrent=!1};async function f(l){const{data:n}=l;try{const{message:r,session:A}=await $fetch("/api/users/admin/sessions",{method:"POST",body:n});v("add",A),i.value=!1,c(),u.add({color:"success",title:"Success",description:r})}catch(r){u.add({color:"error",title:"Error",description:F(r).message})}}return(l,n)=>{const r=M,A=q,d=T,g=G,h=ie,Y=K,y=O;return x(),C("div",null,[b("div",{onClick:n[0]||(n[0]=m=>i.value=!0)},[te(l.$slots,"default",{},()=>[s(r,{label:"New",icon:"lucide:plus"})])]),s(y,{open:e(i),"onUpdate:open":n[4]||(n[4]=m=>U(i)?i.value=m:null),title:"Create Session"},{body:_(()=>[s(Y,{state:e(o),schema:e(me),class:"space-y-5",onSubmit:R(f,["prevent"])},{default:_(()=>[s(d,{name:"name",label:"Session name",required:""},{default:_(()=>[s(A,{modelValue:e(o).name,"onUpdate:modelValue":n[1]||(n[1]=m=>e(o).name=m),size:"lg",class:"w-full"},null,8,["modelValue"])]),_:1}),s(d,{name:"startYear",label:"Official starting year",required:""},{default:_(()=>[s(g,{modelValue:e(o).startYear,"onUpdate:modelValue":n[2]||(n[2]=m=>e(o).startYear=m),size:"lg",class:"w-full",orientation:"vertical","format-options":{useGrouping:"false"}},null,8,["modelValue"])]),_:1}),s(d,{name:"isCurrent",required:""},{default:_(()=>[s(h,{modelValue:e(o).isCurrent,"onUpdate:modelValue":n[3]||(n[3]=m=>e(o).isCurrent=m),size:"lg",label:"Set as current session"},null,8,["modelValue"])]),_:1}),s(r,{type:"submit","loading-auto":"",label:"Submit"})]),_:1},8,["state","schema"])]),_:1},8,["open"])])}}}),_e=Object.assign(pe,{__name:"AdminAcademicSessionCreator"}),fe=E({__name:"editor",props:{session:{}},emits:["update"],setup(S,{emit:p}){const u=D(),v=p,i=P({name:S.session.name,startYear:S.session.startYear}),o=()=>{i.name="",i.startYear=new Date().getFullYear()};async function c(f){const{data:l}=f;try{const{message:n,session:r}=await $fetch(`/api/users/admin/sessions/${S.session.id}`,{method:"PUT",body:l});v("update",r),o(),u.add({color:"success",title:"Success",description:n})}catch(n){u.add({color:"error",title:"Error",description:F(n).message})}}return(f,l)=>{const n=q,r=T,A=G,d=M,g=K;return x(),C("div",null,[s(g,{state:e(i),schema:e(H),class:"space-y-5",onSubmit:R(c,["prevent"])},{default:_(()=>[s(r,{name:"name",label:"Session name",required:""},{default:_(()=>[s(n,{modelValue:e(i).name,"onUpdate:modelValue":l[0]||(l[0]=h=>e(i).name=h),size:"lg",class:"w-full"},null,8,["modelValue"])]),_:1}),s(r,{name:"startYear",label:"Official starting year",required:""},{default:_(()=>[s(A,{modelValue:e(i).startYear,"onUpdate:modelValue":l[1]||(l[1]=h=>e(i).startYear=h),size:"lg",class:"w-full",orientation:"vertical","format-options":{useGrouping:"false"}},null,8,["modelValue"])]),_:1}),s(d,{type:"submit","loading-auto":"",label:"Submit"})]),_:1},8,["state","schema"])])}}}),ge=Object.assign(fe,{__name:"AdminAcademicSessionEditor"}),be={class:"mt-2.5 flex justify-end"},Se=E({__name:"set-current",props:{sessionId:{}},emits:["update"],setup(S,{emit:p}){const u=D(),v=p;async function i(){try{const{message:o}=await $fetch(`/api/users/admin/sessions/${S.sessionId}/set-current`,{method:"PUT"});v("update",S.sessionId),u.add({color:"success",title:"Success",description:o})}catch(o){u.add({color:"error",title:"Error",description:F(o).message})}}return(o,c)=>{const f=M;return x(),C("div",null,[c[0]||(c[0]=b("p",null,"Do you want to set this session as the current session?",-1)),b("div",be,[s(f,{label:"Proceed","loading-auto":"",onClick:i})])])}}}),ye=Object.assign(Se,{__name:"AdminAcademicSessionSetCurrent"}),xe={class:"p-5"},ve={class:"flex items-center gap-5 justify-between"},Ae={class:"mt-5"},he={key:0},we={key:1},Ce={class:"flex justify-center border-t border-default pt-4"},Ye={key:0},tt=E({__name:"index",async setup(S){let p,u;const v=Z,i=ee,o=M,{data:c,error:f,pending:l,refresh:n}=([p,u]=se(()=>de("/api/general/academic-sessions","$fxG4LeaPHo")),p=await p,u(),p),r=ne("table"),A=oe(()=>[{accessorKey:"id",header:"#",cell:({row:a})=>{const t=a.getValue("id");return $("span",{title:t},`${t.slice(0,6)}...`)}},{accessorKey:"name",header:"Name"},{accessorKey:"startYear",header:"Offical Year Started"},{accessorKey:"currentYear",header:"Actual Year Sarted"},{accessorKey:"isCurrent",header:"Current Session",cell:({row:a})=>{const t=a.getValue("isCurrent");return $(v,{class:"capitalize",variant:"subtle",color:t?"success":"error"},()=>`${t}`)}},{accessorKey:"createdAt",header:"Created",cell:({row:a})=>j(a.getValue("createdAt"),"DD MMM, YYYY hh:mm aa").value},{accessorKey:"updatedAt",header:"Updated",cell:({row:a})=>j(a.getValue("updatedAt"),"DD MMM, YYYY hh:mm aa").value},{id:"actions",cell:({row:a})=>$("div",{class:"text-right"},$(i,{content:{align:"end"},items:h(a),"aria-label":"Actions dropdown"},()=>$(o,{icon:"i-lucide-ellipsis-vertical",color:"neutral",variant:"ghost",class:"ml-auto","aria-label":"Actions dropdown"})))}]),d=N(!1),g=N(!1);function h(a){return[{type:"label",label:"Actions"},{label:"Edit Session",onSelect(){m(a.original.id,d)}},{label:"Set as current",onSelect(){m(a.original.id,g)}},{type:"separator"},{label:"Delete session"}]}const Y=N({pageIndex:0,pageSize:10}),y=N(null);function m(a,t){y.value=c.value?.find(k=>k.id===a)??null,y.value&&(t.value=!0)}async function I(a){await n(),y.value=null}return(a,t)=>{const k=_e,J=re,L=le,Q=ce,W=ge,B=O,X=ye;return x(),C("div",xe,[b("header",null,[b("div",ve,[t[7]||(t[7]=b("h1",{class:"text-lg font-bold"},"Academic Sessions",-1)),b("div",null,[e(c)?(x(),ae(k,{key:0,onAdd:t[0]||(t[0]=()=>e(n)())})):z("",!0)])])]),b("section",Ae,[e(f)?(x(),C("div",he,[s(J,{message:("normalizeException"in a?a.normalizeException:e(F))(e(f)).message,"show-retry":"",onRetry:e(n)},null,8,["message","onRetry"])])):e(c)?(x(),C("div",we,[s(L,{ref_key:"table",ref:r,pagination:e(Y),"onUpdate:pagination":t[1]||(t[1]=w=>U(Y)?Y.value=w:null),data:e(c),columns:e(A),loading:e(l),"pagination-options":{getPaginationRowModel:e(ue)()}},null,8,["pagination","data","columns","loading","pagination-options"]),b("div",Ce,[s(Q,{"default-page":(e(r)?.tableApi?.getState().pagination.pageIndex||0)+1,"items-per-page":e(r)?.tableApi?.getState().pagination.pageSize,total:e(r)?.tableApi?.getFilteredRowModel().rows.length,"onUpdate:page":t[2]||(t[2]=w=>e(r)?.tableApi?.setPageIndex(w-1))},null,8,["default-page","items-per-page","total"])]),e(y)?(x(),C("div",Ye,[s(B,{open:e(d),"onUpdate:open":t[4]||(t[4]=w=>U(d)?d.value=w:null),title:"Edit Session"},{body:_(()=>[s(W,{session:e(y),onUpdate:t[3]||(t[3]=()=>I(e(d)))},null,8,["session"])]),_:1},8,["open"]),s(B,{open:e(g),"onUpdate:open":t[6]||(t[6]=w=>U(g)?g.value=w:null),title:"Set Current Session"},{body:_(()=>[s(X,{"session-id":e(y).id,onUpdate:t[5]||(t[5]=()=>I(e(g)))},null,8,["session-id"])]),_:1},8,["open"])])):z("",!0)])):z("",!0)])])}}});export{tt as default};
