import{_ as q}from"./CdUQPPYw.js";import{a as P,_ as B}from"./CfG1-w7I.js";import{_ as D}from"./Cw4EdzfB.js";import{p as C,M as w,_ as U}from"./CEXRc7iu.js";import{f as M,z as S,A as Y,C as F,i as c,o as b,w as o,a as m,b as s,j as v,k as a,g as $,I as k}from"#entry";import{C as g}from"./HZ3APyaO.js";import{z as i}from"./ChM03Ocf.js";import{n as E}from"./Zkazc4B7.js";const A=i.object({firstName:i.string().trim().nonempty("First name is required."),middleName:i.string().trim().optional(),otherNames:i.string().trim().optional(),lastName:i.string().trim().nonempty("Last name is required."),email:i.email("Email is not valid"),password:C.optional(),confirmPassword:i.string().optional(),birthDay:i.number("Birth day is required."),birthMonth:i.string().nonempty("Birth month is required."),birthYear:i.number("Birth year is required").positive("Birth year must be greater than 0").refine(n=>new Date().getFullYear()-n>=w,`You must be at least ${w} years old to continue.`)}).refine(n=>n.password===n.confirmPassword,{message:"Passwords do not match",path:["confirmPassword"]}),I={class:"grid md:grid-cols-2 gap-2.5"},j={class:"md:col-span-2 grid sm:grid-cols-3 gap-2.5"},O={class:"flex justify-end gap-2.5 mt-5"},T=M({__name:"initiation-form",props:{redirect:{default:()=>{}}},emits:["done","cancel"],setup(n,{emit:N}){const d=S(),V=N,_=Y(),t=F({firstName:"",middleName:"",otherNames:"",lastName:"",email:d.user.value?.email??"",birthDay:1,birthMonth:"January",birthYear:new Date().getFullYear()-w}),x=async p=>{if(!d.user.value&&(!t.password||!t.confirmPassword)){_.add({color:"error",title:"Error",description:"Password is required"});return}try{await $fetch("/api/general/applications/initiate",{method:"POST",body:p.data}),V("done",p.data),n.redirect&&await k(n.redirect)}catch(e){_.add({color:"error",title:"Error",description:E(e).message})}};return(p,e)=>{const u=q,r=P,f=D,h=U,y=$,z=B;return b(),c(z,{state:a(t),schema:a(A),onSubmit:x},{default:o(()=>[m("div",I,[e[11]||(e[11]=m("div",{class:"md:col-span-2"},[m("p",{class:"text-lg font-semibold"},"Name")],-1)),s(r,{name:"firstName",label:"First Name",required:""},{default:o(()=>[s(u,{modelValue:a(t).firstName,"onUpdate:modelValue":e[0]||(e[0]=l=>a(t).firstName=l),size:"lg",class:"w-full"},null,8,["modelValue"])]),_:1}),s(r,{name:"middleName",label:"Middle Name"},{default:o(()=>[s(u,{modelValue:a(t).middleName,"onUpdate:modelValue":e[1]||(e[1]=l=>a(t).middleName=l),size:"lg",class:"w-full"},null,8,["modelValue"])]),_:1}),s(r,{name:"lastName",label:"Last Name",required:""},{default:o(()=>[s(u,{modelValue:a(t).lastName,"onUpdate:modelValue":e[2]||(e[2]=l=>a(t).lastName=l),size:"lg",class:"w-full"},null,8,["modelValue"])]),_:1}),s(r,{name:"otherNames",label:"Other Names"},{default:o(()=>[s(u,{modelValue:a(t).otherNames,"onUpdate:modelValue":e[3]||(e[3]=l=>a(t).otherNames=l),size:"lg",class:"w-full"},null,8,["modelValue"])]),_:1}),e[12]||(e[12]=m("div",{class:"mt-5 md:col-span-2"},[m("p",{class:"text-lg font-semibold"},"Birth Data")],-1)),m("div",j,[s(r,{name:"birthDay",label:"Day of Birth",required:""},{default:o(()=>[s(f,{modelValue:a(t).birthDay,"onUpdate:modelValue":e[4]||(e[4]=l=>a(t).birthDay=l),items:a(g).monthDays(),size:"lg",class:"w-full"},null,8,["modelValue","items"])]),_:1}),s(r,{name:"birthMonth",label:"Month of Birth",required:""},{default:o(()=>[s(f,{modelValue:a(t).birthMonth,"onUpdate:modelValue":e[5]||(e[5]=l=>a(t).birthMonth=l),items:a(g).months().long,size:"lg",class:"w-full"},null,8,["modelValue","items"])]),_:1}),s(r,{name:"birthYear",label:"Day of Birth",required:""},{default:o(()=>[s(f,{modelValue:a(t).birthYear,"onUpdate:modelValue":e[6]||(e[6]=l=>a(t).birthYear=l),items:a(g).allowedYears(),size:"lg",class:"w-full"},null,8,["modelValue","items"])]),_:1})]),e[13]||(e[13]=m("div",{class:"mt-5 md:col-span-2"},[m("p",{class:"text-lg font-semibold"},"Credentials")],-1)),s(r,{name:"email",label:"Email Address",required:"",class:"md:col-span-2"},{default:o(()=>[s(u,{modelValue:a(t).email,"onUpdate:modelValue":e[7]||(e[7]=l=>a(t).email=l),disabled:!!a(d).user.value,size:"lg",class:"w-full"},null,8,["modelValue","disabled"])]),_:1}),a(d).user.value?v("",!0):(b(),c(r,{key:0,name:"password",label:"Password",required:""},{default:o(()=>[s(h,{modelValue:a(t).password,"onUpdate:modelValue":e[8]||(e[8]=l=>a(t).password=l),size:"lg",class:"w-full"},null,8,["modelValue"])]),_:1})),a(d).user.value?v("",!0):(b(),c(r,{key:1,name:"confirmPassword",label:"Confirm Password",required:""},{default:o(()=>[s(h,{modelValue:a(t).confirmPassword,"onUpdate:modelValue":e[9]||(e[9]=l=>a(t).confirmPassword=l),size:"lg",class:"w-full"},null,8,["modelValue"])]),_:1}))]),m("div",O,[s(y,{type:"button",label:"Cancel",color:"neutral",variant:"soft",size:"lg",onClick:e[10]||(e[10]=l=>V("cancel"))}),s(y,{type:"submit",label:"Submit",size:"lg","loading-auto":""})])]),_:1},8,["state","schema"])}}}),X=Object.assign(T,{__name:"ApplicationInitiationForm"});export{X as _};
