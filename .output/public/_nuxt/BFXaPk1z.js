import{_ as y}from"./BzV1xtw9.js";import{_ as k,a as S,b as V}from"./Dcr2-6YO.js";import{f as C,q as z,v as $,x as _,c as f,k as B,b as t,i as n,w as o,y as F,H as U,m as j,o as d,g as A,d as I,a as p,z as M}from"#entry";import{n as R}from"./Zkazc4B7.js";import{z as w}from"./Jvy9P-lb.js";const q={key:0,class:"mb-3"},K=C({__name:"change-email-form",setup(H){const c=z(),b=w.object({newEmail:w.email("Invalid email address")}),a=$({newEmail:""});function g(){a.newEmail=""}const s=_(null),l=_(!1);async function x(r){s.value=null;const{newEmail:e}=r.data;await M.changeEmail({newEmail:e,callbackURL:"/login"},{onError(i){s.value=R(i.error)},onSuccess(){g(),l.value=!0,c.setUser(null),c.setSession(null)}})}return(r,e)=>{const i=y,E=V,v=S,u=A,h=k,N=j;return d(),f("div",null,[n(s)?(d(),f("div",q,[t(i,{message:n(s).message},null,8,["message"])])):B("",!0),t(h,{schema:n(b),state:n(a),class:"space-y-4",onSubmit:F(x,["prevent"])},{default:o(()=>[t(v,{label:"New Email",name:"newEmail"},{default:o(()=>[t(E,{modelValue:n(a).newEmail,"onUpdate:modelValue":e[0]||(e[0]=m=>n(a).newEmail=m),size:"lg",class:"w-full"},null,8,["modelValue"])]),_:1}),t(u,{type:"submit",class:"mt-2 w-full flex-center",size:"lg",icon:"i-lucide:check-circle","loading-auto":""},{default:o(()=>[...e[2]||(e[2]=[I(" Submit ",-1)])]),_:1})]),_:1},8,["schema","state"]),t(N,{open:n(l),"onUpdate:open":e[1]||(e[1]=m=>U(l)?l.value=m:null),title:"Success",close:!1,dismissible:!1,ui:{footer:"justify-end"}},{body:o(()=>[...e[3]||(e[3]=[p("div",{class:"space-y-3"},[p("p",null," Click the link that has been sent to your current email to continue ")],-1)])]),footer:o(()=>[t(u,{to:"/login",label:"Continue","trailing-icon":"lucide:circle-arrow-right"})]),_:1},8,["open"])])}}});export{K as _};
